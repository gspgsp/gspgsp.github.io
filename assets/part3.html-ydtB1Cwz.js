import{_ as n,c as e,f as a,o as i}from"./app-BB_BIQV8.js";const l={};function d(t,s){return i(),e("div",null,s[0]||(s[0]=[a(`<h2 id="_1-è¿è¡Œminikube" tabindex="-1"><a class="header-anchor" href="#_1-è¿è¡Œminikube"><span>1.è¿è¡Œminikube</span></a></h2><blockquote><p>$ minikube start</p></blockquote><p>è¿è¡Œç»“æœå¦‚ä¸‹:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">ğŸ˜„  minikube v1.34.0 on Kylin V10</span>
<span class="line">âœ¨  Using the docker driver based on existing profile</span>
<span class="line">â—  Local proxy ignored: not passing HTTP_PROXY=http://127.0.0.1:7890/ to docker env.</span>
<span class="line">â—  Local proxy ignored: not passing HTTPS_PROXY=http://127.0.0.1:7890/ to docker env.</span>
<span class="line">â—  Local proxy ignored: not passing HTTP_PROXY=http://127.0.0.1:7890/ to docker env.</span>
<span class="line">â—  Local proxy ignored: not passing HTTPS_PROXY=http://127.0.0.1:7890/ to docker env.</span>
<span class="line">ğŸ‘  Starting &quot;minikube&quot; primary control-plane node in &quot;minikube&quot; cluster</span>
<span class="line">ğŸšœ  Pulling base image v0.0.45 ...</span>
<span class="line">    &gt; index.docker.io/kicbase/sta...:  487.90 MiB / 487.90 MiB  100.00% 558.69 </span>
<span class="line">â—  minikube was unable to download gcr.io/k8s-minikube/kicbase:v0.0.45, but successfully downloaded docker.io/kicbase/stable:v0.0.45 as a fallback image</span>
<span class="line">ğŸ¤·  docker &quot;minikube&quot; container is missing, will recreate.</span>
<span class="line">ğŸ”¥  Creating docker container (CPUs=2, Memory=7900MB) ...</span>
<span class="line">â—  Local proxy ignored: not passing HTTP_PROXY=http://127.0.0.1:7890/ to docker env.</span>
<span class="line">â—  Local proxy ignored: not passing HTTPS_PROXY=http://127.0.0.1:7890/ to docker env.</span>
<span class="line">â—  Local proxy ignored: not passing HTTP_PROXY=http://127.0.0.1:7890/ to docker env.</span>
<span class="line">â—  Local proxy ignored: not passing HTTPS_PROXY=http://127.0.0.1:7890/ to docker env.</span>
<span class="line">â—  Local proxy ignored: not passing HTTP_PROXY=http://127.0.0.1:7890/ to docker env.</span>
<span class="line">â—  Local proxy ignored: not passing HTTPS_PROXY=http://127.0.0.1:7890/ to docker env.</span>
<span class="line">â—  Local proxy ignored: not passing HTTP_PROXY=http://127.0.0.1:7890/ to docker env.</span>
<span class="line">â—  Local proxy ignored: not passing HTTPS_PROXY=http://127.0.0.1:7890/ to docker env.</span>
<span class="line">ğŸŒ  Found network options:</span>
<span class="line">    â–ª HTTP_PROXY=http://127.0.0.1:7890/</span>
<span class="line">â—  You appear to be using a proxy, but your NO_PROXY environment does not include the minikube IP (192.168.49.2).</span>
<span class="line">ğŸ“˜  Please see https://minikube.sigs.k8s.io/docs/handbook/vpn_and_proxy/ for more details</span>
<span class="line">    â–ª HTTPS_PROXY=http://127.0.0.1:7890/</span>
<span class="line">    â–ª NO_PROXY=localhost,127.0.0.0/8,::1</span>
<span class="line">    â–ª HTTP_PROXY=http://127.0.0.1:7890/</span>
<span class="line">    â–ª HTTPS_PROXY=http://127.0.0.1:7890/</span>
<span class="line">    â–ª NO_PROXY=localhost,127.0.0.0/8,::1</span>
<span class="line">â—  Failing to connect to https://registry.k8s.io/ from both inside the minikube container and host machine</span>
<span class="line">ğŸ’¡  To pull new external images, you may need to configure a proxy: https://minikube.sigs.k8s.io/docs/reference/networking/proxy/</span>
<span class="line">ğŸ³  Preparing Kubernetes v1.31.0 on Docker 27.2.0 ...</span>
<span class="line">    â–ª env NO_PROXY=localhost,127.0.0.0/8,::1</span>
<span class="line">    â–ª Generating certificates and keys ...</span>
<span class="line">    â–ª Booting up control plane ...</span>
<span class="line">    â–ª Configuring RBAC rules ...</span>
<span class="line">ğŸ”—  Configuring bridge CNI (Container Networking Interface) ...</span>
<span class="line">ğŸ”  Verifying Kubernetes components...</span>
<span class="line">    â–ª Using image gcr.io/k8s-minikube/storage-provisioner:v5</span>
<span class="line">ğŸŒŸ  Enabled addons: storage-provisioner, default-storageclass</span>
<span class="line">ğŸ’¡  kubectl not found. If you need it, try: &#39;minikube kubectl -- get pods -A&#39;</span>
<span class="line">ğŸ„  Done! kubectl is now configured to use &quot;minikube&quot; cluster and &quot;default&quot; namespace by default</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨çš„é—®é¢˜æ˜¯:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">Failing to connect to https://registry.k8s.io/ from both inside the minikube container and host machine</span>
<span class="line">è¿™ä¸ªé—®é¢˜åŸºæœ¬ä¸Šæ— è§£ï¼Œåªèƒ½é€šè¿‡æ‰‹åŠ¨pull ç„¶å loadçš„æ–¹å¼è§£å†³.</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-goé¡¹ç›®å‘å¸ƒ" tabindex="-1"><a class="header-anchor" href="#_2-goé¡¹ç›®å‘å¸ƒ"><span>2.goé¡¹ç›®å‘å¸ƒ</span></a></h2><h3 id="_2-1-è¿›å…¥é¡¹ç›®" tabindex="-1"><a class="header-anchor" href="#_2-1-è¿›å…¥é¡¹ç›®"><span>2.1 è¿›å…¥é¡¹ç›®</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">$ cd go-gateway-demo</span>
<span class="line">$ docker build -t go-gateway-demo:0.1 .</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-åŠ è½½æœ¬åœ°é•œåƒåˆ°minikubeå®¹å™¨" tabindex="-1"><a class="header-anchor" href="#_2-2-åŠ è½½æœ¬åœ°é•œåƒåˆ°minikubeå®¹å™¨"><span>2.2 åŠ è½½æœ¬åœ°é•œåƒåˆ°minikubeå®¹å™¨</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">$ minikube image load go-gateway-demo:0.1</span>
<span class="line"></span>
<span class="line">//æŸ¥çœ‹æ˜¯å¦åŠ è½½æˆåŠŸ</span>
<span class="line">$ minikube image ls | grep go-gateway-demo</span>
<span class="line">docker.io/library/go-gateway-demo:0.1</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-3-éƒ¨ç½²deployment-service" tabindex="-1"><a class="header-anchor" href="#_2-3-éƒ¨ç½²deployment-service"><span>2.3 éƒ¨ç½²Deployment + Service</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">kubectl apply -f deploy/deployment.yaml</span>
<span class="line">kubectl apply -f deploy/service.yaml</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-4-éƒ¨ç½²gateway" tabindex="-1"><a class="header-anchor" href="#_2-4-éƒ¨ç½²gateway"><span>2.4 éƒ¨ç½²gateway</span></a></h3><h4 id="_2-4-1-è¿™ä¸ªéœ€è¦-gateway-api-crd-å’Œ-gateway-istio-æ§åˆ¶å¹³é¢" tabindex="-1"><a class="header-anchor" href="#_2-4-1-è¿™ä¸ªéœ€è¦-gateway-api-crd-å’Œ-gateway-istio-æ§åˆ¶å¹³é¢"><span>2.4.1 è¿™ä¸ªéœ€è¦ Gateway API CRD å’Œ Gateway Istio æ§åˆ¶å¹³é¢</span></a></h4><p>å®‰è£…CRD</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">kubectl apply -k github.com/kubernetes-sigs/gateway-api/config/crd?ref=v1.0.0</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å®‰è£…Istio</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">curl -L https://istio.io/downloadIstio | sh -</span>
<span class="line">cd istio-*</span>
<span class="line">./bin/istioctl install --set profile=demo -y</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯èƒ½ä¼šæœ‰å¦‚ä¸‹é”™è¯¯:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">$ ./bin/istioctl install --set profile=demo -y</span>
<span class="line">        |\\          </span>
<span class="line">        | \\         </span>
<span class="line">        |  \\        </span>
<span class="line">        |   \\       </span>
<span class="line">      /||    \\      </span>
<span class="line">     / ||     \\     </span>
<span class="line">    /  ||      \\    </span>
<span class="line">   /   ||       \\   </span>
<span class="line">  /    ||        \\  </span>
<span class="line"> /     ||         \\ </span>
<span class="line">/______||__________\\</span>
<span class="line">____________________</span>
<span class="line">  \\__       _____/  </span>
<span class="line">     \\_____/        </span>
<span class="line"></span>
<span class="line">âœ” Istio core installed â›µï¸                                                                                                                                                                                          </span>
<span class="line">âœ˜ Istiod encountered an error: failed to wait for resource: resources not ready after 5m0s: context deadline exceeded                                                                                              </span>
<span class="line">  Deployment/istio-system/istiod (container failed to start: ImagePullBackOff: Back-off pulling image &quot;docker.io/istio/pilot:1.28.2&quot;)</span>
<span class="line">âœ˜ Egress gateways encountered an error: failed to wait for resource: resources not ready after 5m0s: context deadline exceededent/istio-system/istio-ingressgateway                                                </span>
<span class="line">  Deployment/istio-system/istio-egressgateway (container failed to start: ContainerCreating: )</span>
<span class="line">âœ˜ Ingress gateways encountered an error: failed to wait for resource: resources not ready after 5m0s: context deadline exceeded</span>
<span class="line">  Deployment/istio-system/istio-ingressgateway (container failed to start: ContainerCreating: )</span>
<span class="line">Error: failed to install manifests: 3 errors occurred:</span>
<span class="line">  * failed to wait for resource: resources not ready after 5m0s: context deadline exceeded</span>
<span class="line">  Deployment/istio-system/istiod (container failed to start: ImagePullBackOff: Back-off pulling image &quot;docker.io/istio/pilot:1.28.2&quot;)</span>
<span class="line">  * failed to wait for resource: resources not ready after 5m0s: context deadline exceeded</span>
<span class="line">  Deployment/istio-system/istio-egressgateway (container failed to start: ContainerCreating: )</span>
<span class="line">  * failed to wait for resource: resources not ready after 5m0s: context deadline exceeded</span>
<span class="line">  Deployment/istio-system/istio-ingressgateway (container failed to start: ContainerCreating: )</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿˜æ˜¯è€é—®é¢˜ï¼Œminikube é‡Œçš„dockeræ— æ³•pull image, åªèƒ½æ‰‹åŠ¨æ“ä½œ</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line"># åˆ—å‡º Istio 1.28.2 éœ€è¦çš„æ‰€æœ‰é•œåƒ</span>
<span class="line">docker pull docker.io/istio/pilot:1.28.2</span>
<span class="line">docker pull docker.io/istio/proxyv2:1.28.2</span>
<span class="line">docker pull docker.io/istio/install-cni:1.28.2</span>
<span class="line"></span>
<span class="line">minikube image load docker.io/istio/pilot:1.28.2</span>
<span class="line">minikube image load docker.io/istio/proxyv2:1.28.2</span>
<span class="line">minikube image load docker.io/istio/install-cni:1.28.2</span>
<span class="line"></span>
<span class="line">minikube image ls | grep istio</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å†æ¬¡æ‰§è¡Œ:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">$ ./bin/istioctl install --set profile=demo -y</span>
<span class="line">|\\          </span>
<span class="line">| \\         </span>
<span class="line">|  \\        </span>
<span class="line">|   \\       </span>
<span class="line">/||    \\      </span>
<span class="line">/ ||     \\     </span>
<span class="line">/  ||      \\    </span>
<span class="line">/   ||       \\   </span>
<span class="line">/    ||        \\  </span>
<span class="line">/     ||         \\</span>
<span class="line">/______||__________\\</span>
<span class="line">____________________</span>
<span class="line">\\__       _____/  </span>
<span class="line">\\_____/</span>
<span class="line"></span>
<span class="line">âœ” Istio core installed â›µï¸                                                                                                                                                                                          </span>
<span class="line">âœ” Istiod installed ğŸ§                                                                                                                                                                                               </span>
<span class="line">âœ” Egress gateways installed ğŸ›«                                                                                                                                                                                     </span>
<span class="line">âœ” Ingress gateways installed ğŸ›¬                                                                                                                                                                                    </span>
<span class="line">âœ” Installation complete  </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç®€å•éªŒè¯:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">$ kubectl get pods -n istio-system</span>
<span class="line">NAME                                   READY   STATUS    RESTARTS   AGE</span>
<span class="line">istio-egressgateway-75496bf7d-lhbrj    1/1     Running   0          23m</span>
<span class="line">istio-ingressgateway-79b788656-hqqwc   1/1     Running   0          23m</span>
<span class="line">istiod-696d4c8c9f-8nfnj                1/1     Running   0          28m</span>
<span class="line"></span>
<span class="line">$ kubectl get gatewayclass</span>
<span class="line">NAME           CONTROLLER                    ACCEPTED   AGE</span>
<span class="line">istio          istio.io/gateway-controller   True       4m44s</span>
<span class="line">istio-remote   istio.io/unmanaged-gateway    True       4m44s</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><p>ç»§ç»­æ‰§è¡Œ:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">$ kubectl apply -f deploy/gateway.yaml</span>
<span class="line">gatewayclass.gateway.networking.k8s.io/demo-gateway-class unchanged</span>
<span class="line">gateway.gateway.networking.k8s.io/demo-gateway configured</span>
<span class="line">httproute.gateway.networking.k8s.io/go-demo-route created</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>okï¼Œéå¸¸å®Œç¾çš„è§£å†³é—®é¢˜ï¼</p><p>é…ç½®hostsæ–‡ä»¶</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">$ minikube ip</span>
<span class="line">192.168.49.2</span>
<span class="line"></span>
<span class="line">192.168.49.2 demo.local</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è®¿é—®:</p><blockquote><p>curl http://demo.local/ æ²¡æœ‰ä»»ä½•è¾“å‡ºï¼Œåº”è¯¥æ˜¯ä¸Šé¢çš„èµ„æºæœ‰é—®é¢˜</p></blockquote><p>åˆ†æï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">$ kubectl describe gateway demo-gateway</span>
<span class="line">Name:         demo-gateway</span>
<span class="line">Namespace:    default</span>
<span class="line">Labels:       &lt;none&gt;</span>
<span class="line">Annotations:  &lt;none&gt;</span>
<span class="line">API Version:  gateway.networking.k8s.io/v1</span>
<span class="line">Kind:         Gateway</span>
<span class="line">Metadata:</span>
<span class="line">Creation Timestamp:  2026-01-12T04:13:00Z</span>
<span class="line">Generation:          1</span>
<span class="line">Resource Version:    22475</span>
<span class="line">UID:                 6fca25f4-f94c-4cd0-8868-0cc07756edd2</span>
<span class="line">Spec:</span>
<span class="line">Gateway Class Name:  demo-gateway-class</span>
<span class="line">Listeners:</span>
<span class="line">Allowed Routes:</span>
<span class="line">Namespaces:</span>
<span class="line">From:  Same</span>
<span class="line">Name:      http</span>
<span class="line">Port:      80</span>
<span class="line">Protocol:  HTTP</span>
<span class="line">Status:</span>
<span class="line">Conditions:</span>
<span class="line">Last Transition Time:  2026-01-12T04:13:00Z</span>
<span class="line">Message:               Resource accepted</span>
<span class="line">Observed Generation:   1</span>
<span class="line">Reason:                Accepted</span>
<span class="line">Status:                True</span>
<span class="line">Type:                  Accepted</span>
<span class="line">Last Transition Time:  2026-01-12T04:13:00Z</span>
<span class="line">Message:               Assigned to service(s) demo-gateway-demo-gateway-class.default.svc.cluster.local:80, but failed to assign to all requested addresses: address pending for hostname &quot;demo-gateway-demo-gateway-class.default.svc.cluster.local&quot;</span>
<span class="line">Observed Generation:   1</span>
<span class="line">Reason:                AddressNotAssigned</span>
<span class="line">Status:                False</span>
<span class="line">Type:                  Programmed</span>
<span class="line">Listeners:</span>
<span class="line">Attached Routes:  1</span>
<span class="line">Conditions:</span>
<span class="line">Last Transition Time:  2026-01-12T04:13:00Z</span>
<span class="line">Message:               No errors found</span>
<span class="line">Observed Generation:   1</span>
<span class="line">Reason:                Accepted</span>
<span class="line">Status:                True</span>
<span class="line">Type:                  Accepted</span>
<span class="line">Last Transition Time:  2026-01-12T04:13:00Z</span>
<span class="line">Message:               No errors found</span>
<span class="line">Observed Generation:   1</span>
<span class="line">Reason:                NoConflicts</span>
<span class="line">Status:                False</span>
<span class="line">Type:                  Conflicted</span>
<span class="line">Last Transition Time:  2026-01-12T04:13:00Z</span>
<span class="line">Message:               No errors found</span>
<span class="line">Observed Generation:   1</span>
<span class="line">Reason:                Programmed</span>
<span class="line">Status:                True</span>
<span class="line">Type:                  Programmed</span>
<span class="line">Last Transition Time:  2026-01-12T04:13:00Z</span>
<span class="line">Message:               No errors found</span>
<span class="line">Observed Generation:   1</span>
<span class="line">Reason:                ResolvedRefs</span>
<span class="line">Status:                True</span>
<span class="line">Type:                  ResolvedRefs</span>
<span class="line">Name:                    http</span>
<span class="line">Supported Kinds:</span>
<span class="line">Group:  gateway.networking.k8s.io</span>
<span class="line">Kind:   HTTPRoute</span>
<span class="line">Group:  gateway.networking.k8s.io</span>
<span class="line">Kind:   GRPCRoute</span>
<span class="line">Events:       &lt;none&gt;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»ä¸Šé¢çš„Messageåˆ†æå¯ä»¥çŸ¥é“, LoadBalancer çš„ EXTERNAL-IP ä¸€ç›´æ˜¯ <code>&lt;pending&gt;</code>ï¼Œåœ¨ Minikube ç¯å¢ƒä¸­ LoadBalancer æ— æ³•è·å¾—å¤–éƒ¨ IPã€‚</p><p>æ‰§è¡Œ:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">$ minikube tunnel</span>
<span class="line">Status:</span>
<span class="line">machine: minikube</span>
<span class="line">pid: 65675</span>
<span class="line">route: 10.96.0.0/12 -&gt; 192.168.49.2</span>
<span class="line">minikube: Running</span>
<span class="line">services: [demo-gateway-demo-gateway-class, istio-ingressgateway]</span>
<span class="line">errors:</span>
<span class="line">minikube: no errors</span>
<span class="line">router: no errors</span>
<span class="line">loadbalancer emulator: no errors</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªå‘½ä»¤ä¼šè®© Minikube çš„ LoadBalancer æœåŠ¡è·å¾— IP åœ°å€ã€‚è¿è¡Œåå¯ä»¥çœ‹åˆ°è¾“å‡ºï¼Œç„¶åä¿æŒè¿™ä¸ªç»ˆç«¯å¼€æ”¾ã€‚</p><p>ç„¶åæ£€æŸ¥ Service çš„ EXTERNAL-IPï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">$ kubectl get svc demo-gateway-demo-gateway-class</span>
<span class="line">NAME                              TYPE           CLUSTER-IP     EXTERNAL-IP    PORT(S)                        AGE</span>
<span class="line">demo-gateway-demo-gateway-class   LoadBalancer   10.96.233.91   10.96.233.91   15021:30819/TCP,80:30195/TCP   92m</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>çœŸçš„æœ‰æ•ˆï¼ŒEXTERNAL-IP æœ‰æ•°æ®äº†, ä¸å†æ˜¯pending</p><hr><p>ç›´æ¥æµ‹è¯•go-demoæ˜¯å¦å·¥ä½œ:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">$ kubectl port-forward svc/go-demo 8080:80</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç„¶ååœ¨å¦ä¸€ä¸ªç»ˆç«¯:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">$ curl http://localhost:8080</span>
<span class="line"></span>
<span class="line">è¯´æ˜go-demoæœåŠ¡æ˜¯å¯ä»¥æ­£å¸¸å·¥ä½œçš„</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•Host:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">$ curl http://10.96.233.91 -H &quot;Host: demo.local&quot; -v</span>
<span class="line">* Uses proxy env variable no_proxy == &#39;localhost,127.0.0.0/8,::1&#39;</span>
<span class="line">* Uses proxy env variable http_proxy == &#39;http://127.0.0.1:7890/&#39;</span>
<span class="line">*   Trying 127.0.0.1:7890...</span>
<span class="line">* Connected to (nil) (127.0.0.1) port 7890 (#0)</span>
<span class="line">&gt; GET http://10.96.233.91/ HTTP/1.1</span>
<span class="line">&gt; Host: demo.local</span>
<span class="line">&gt; User-Agent: curl/7.81.0</span>
<span class="line">&gt; Accept: */*</span>
<span class="line">&gt; Proxy-Connection: Keep-Alive</span>
<span class="line">&gt;</span>
<span class="line">* Mark bundle as not supporting multiuse</span>
<span class="line">  &lt; HTTP/1.1 502 Bad Gateway</span>
<span class="line">  &lt; Connection: keep-alive</span>
<span class="line">  &lt; Keep-Alive: timeout=4</span>
<span class="line">  &lt; Proxy-Connection: keep-alive</span>
<span class="line">  &lt; Content-Length: 0</span>
<span class="line">  &lt;</span>
<span class="line">* Connection #0 to host (nil) left intact</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç”±äº10.96.233.91èµ°äº†ä»£ç†ï¼Œæ‰€ä»¥æŠ¥é”™</p><p>ç›´æ¥åœ¨å½“å‰ç»ˆç«¯:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">$ unset http_proxy</span>
<span class="line">unset https_proxy</span>
<span class="line">unset HTTP_PROXY</span>
<span class="line">unset HTTPS_PROXY</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åæ‰§è¡Œ:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">$ curl http://10.96.233.91 -H &quot;Host: demo.local&quot; -v</span>
<span class="line">* Uses proxy env variable no_proxy == &#39;localhost,127.0.0.0/8,::1&#39;</span>
<span class="line">*   Trying 10.96.233.91:80...</span>
<span class="line">* Connected to 10.96.233.91 (10.96.233.91) port 80 (#0)</span>
<span class="line">&gt; GET / HTTP/1.1</span>
<span class="line">&gt; Host: demo.local</span>
<span class="line">&gt; User-Agent: curl/7.81.0</span>
<span class="line">&gt; Accept: */*</span>
<span class="line">&gt;</span>
<span class="line">* Mark bundle as not supporting multiuse</span>
<span class="line">  &lt; HTTP/1.1 200 OK</span>
<span class="line">  &lt; date: Mon, 12 Jan 2026 05:52:48 GMT</span>
<span class="line">  &lt; content-length: 34</span>
<span class="line">  &lt; content-type: text/plain; charset=utf-8</span>
<span class="line">  &lt; x-envoy-upstream-service-time: 0</span>
<span class="line">  &lt; server: istio-envoy</span>
<span class="line">  &lt;</span>
<span class="line">* Connection #0 to host 10.96.233.91 left intact</span>
<span class="line">  hello from go on k8s + gateway api</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å‘ç°å¯ä»¥æ­£å¸¸è®¿é—®</p><p>ç»§ç»­ç”¨ä¹‹å‰é…ç½®</p><blockquote><p>curl http://demo.localè®¿é—®, å‘ç°è¿˜æ˜¯è®¿é—®ä¸äº†</p></blockquote><p>åŸå› å¦‚ä¸‹:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">demo.local â†’ 192.168.49.2</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>Gateway å®é™…ç›‘å¬çš„æ˜¯</strong>ï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">demo-gateway-demo-gateway-class (Service: LoadBalancer)</span>
<span class="line">CLUSTER-IP: 10.96.233.91</span>
<span class="line">PORT: 80</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¹Ÿå°±æ˜¯è¯´ï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">curl http://demo.local</span>
<span class="line">   â†“</span>
<span class="line">192.168.49.2:80   âŒ æ²¡æœ‰ Gateway åœ¨è¿™é‡Œç›‘å¬</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰€ä»¥å¾—åˆ°çš„ç»“æœåªèƒ½æ˜¯ï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">Connection refused</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>192.168.49.2 æ˜¯è°ï¼Ÿ è¿™æ˜¯ <strong>minikube VM çš„ Node IP</strong>ï¼Œä¸æ˜¯ Gatewayã€‚</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">minikube ip</span>
<span class="line"># è¾“å‡ºï¼š192.168.49.2</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½†æ³¨æ„ä¸€ä¸ªå…³é”®ç‚¹ğŸ‘‡</p><blockquote><p><strong>ç°åœ¨çš„ Gateway å¹¶ä¸æ˜¯ NodePort</strong></p><p>å®ƒæ˜¯ <code>Service type: LoadBalancer</code></p></blockquote><p>æ‰€ä»¥ï¼š</p><table><thead><tr><th>IP</th><th>è§’è‰²</th><th>æ˜¯å¦ç›‘å¬ 80</th></tr></thead><tbody><tr><td><code>192.168.49.2</code></td><td>minikube èŠ‚ç‚¹</td><td>âŒ</td></tr><tr><td><code>10.96.233.91</code></td><td>LB è™šæ‹Ÿ IP</td><td>âœ…ï¼ˆé€šè¿‡ tunnelï¼‰</td></tr></tbody></table><p>ç°åœ¨çš„è·¯ç”±:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">æœ¬æœº</span>
<span class="line">  â””â”€â”€ è·¯ç”±è¡¨</span>
<span class="line">       â””â”€â”€ 10.96.0.0/12 â†’ 192.168.49.2</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰€ä»¥è§£å†³åŠæ³•, åœ¨æœ¬æœºçš„ /etc/hostsä¸‹ï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">10.96.233.91 demo.local</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å†æ¬¡è®¿é—®: http://demo.local å‘ç°è®¿é—®æˆåŠŸ</p><p>æ³¨æ„ï¼š</p><blockquote><p>Clashå·¥å…·é…ç½®no_proxyï¼Œæ ¹æœ¬ä¸Šè§£å†³ä»£ç†é—®é¢˜: localhost, 127.0.0.0/8, ::1, demo.local, 10.96.0.0/12</p></blockquote>`,80)]))}const r=n(l,[["render",d],["__file","part3.html.vue"]]),p=JSON.parse('{"path":"/project/k8s/part3.html","title":"","lang":"en-US","frontmatter":{"sidebarDepth":0},"headers":[{"level":2,"title":"1.è¿è¡Œminikube","slug":"_1-è¿è¡Œminikube","link":"#_1-è¿è¡Œminikube","children":[]},{"level":2,"title":"2.goé¡¹ç›®å‘å¸ƒ","slug":"_2-goé¡¹ç›®å‘å¸ƒ","link":"#_2-goé¡¹ç›®å‘å¸ƒ","children":[{"level":3,"title":"2.1 è¿›å…¥é¡¹ç›®","slug":"_2-1-è¿›å…¥é¡¹ç›®","link":"#_2-1-è¿›å…¥é¡¹ç›®","children":[]},{"level":3,"title":"2.2 åŠ è½½æœ¬åœ°é•œåƒåˆ°minikubeå®¹å™¨","slug":"_2-2-åŠ è½½æœ¬åœ°é•œåƒåˆ°minikubeå®¹å™¨","link":"#_2-2-åŠ è½½æœ¬åœ°é•œåƒåˆ°minikubeå®¹å™¨","children":[]},{"level":3,"title":"2.3 éƒ¨ç½²Deployment + Service","slug":"_2-3-éƒ¨ç½²deployment-service","link":"#_2-3-éƒ¨ç½²deployment-service","children":[]},{"level":3,"title":"2.4 éƒ¨ç½²gateway","slug":"_2-4-éƒ¨ç½²gateway","link":"#_2-4-éƒ¨ç½²gateway","children":[]}]}],"git":{},"filePathRelative":"project/k8s/part3.md"}');export{r as comp,p as data};
