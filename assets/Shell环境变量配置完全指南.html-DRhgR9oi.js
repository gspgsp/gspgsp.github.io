import{_ as n,c as a,f as e,o as l}from"./app-BB_BIQV8.js";const i={};function t(p,s){return l(),a("div",null,s[0]||(s[0]=[e(`<h1 id="shell-环境变量配置完全指南-修正版" tabindex="-1"><a class="header-anchor" href="#shell-环境变量配置完全指南-修正版"><span>Shell 环境变量配置完全指南（修正版）</span></a></h1><h2 id="一、配置文件概览" tabindex="-1"><a class="header-anchor" href="#一、配置文件概览"><span>一、配置文件概览</span></a></h2><table><thead><tr><th>文件</th><th>作用域</th><th>何时加载</th><th>适用 shell</th><th>优先级</th></tr></thead><tbody><tr><td><code>/etc/profile</code></td><td>系统全局</td><td><strong>Login shell 时</strong></td><td>所有 shell</td><td>低</td></tr><tr><td><code>/etc/bash.bashrc</code></td><td>系统全局</td><td><strong>每个 bash 启动时</strong></td><td>bash</td><td>中</td></tr><tr><td><code>~/.profile</code></td><td>用户</td><td><strong>Login shell 时</strong></td><td>所有 shell</td><td>中</td></tr><tr><td><code>~/.bashrc</code></td><td>用户</td><td><strong>非 login bash 启动时</strong></td><td>bash</td><td>高</td></tr><tr><td><code>~/.zshrc</code></td><td>用户</td><td><strong>非 login zsh 启动时</strong></td><td>zsh</td><td>高</td></tr></tbody></table><p><strong>优先级说明：</strong> 高优先级的配置会覆盖低优先级的配置</p><hr><h2 id="二、shell-类型详解" tabindex="-1"><a class="header-anchor" href="#二、shell-类型详解"><span>二、Shell 类型详解</span></a></h2><h3 id="login-shell-登录-shell" tabindex="-1"><a class="header-anchor" href="#login-shell-登录-shell"><span>Login Shell（登录 shell）</span></a></h3><p><strong>定义：</strong> 需要输入用户名和密码的 shell</p><p><strong>真实场景：</strong></p><ul><li>SSH 远程登录</li><li>虚拟机启动时的初始 TTY 命令行登录（输入用户名密码）</li><li><code>bash --login</code> 显式启动 login shell</li></ul><p><strong>加载顺序：</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">/etc/profile → ~/.profile（或 ~/.bash_profile）</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="non-login-shell-非登录-shell" tabindex="-1"><a class="header-anchor" href="#non-login-shell-非登录-shell"><span>Non-login Shell（非登录 shell）</span></a></h3><p><strong>定义：</strong> 已经登录后再打开的 shell</p><p><strong>真实场景：</strong></p><ul><li>在已打开的终端中输入 <code>bash</code> 命令</li><li>从图形界面打开新的终端窗口/标签页</li><li>脚本中启动的 bash</li></ul><p><strong>加载顺序：</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">/etc/bash.bashrc → ~/.bashrc</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><hr><h2 id="三、详细加载流程" tabindex="-1"><a class="header-anchor" href="#三、详细加载流程"><span>三、详细加载流程</span></a></h2><h3 id="场景-a-ubuntu-22-图形界面开机-最常见" tabindex="-1"><a class="header-anchor" href="#场景-a-ubuntu-22-图形界面开机-最常见"><span>场景 A：Ubuntu 22 图形界面开机（最常见）</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">1. 开机</span>
<span class="line">2. 启动图形管理器（不是 login shell）</span>
<span class="line">3. 显示登录界面</span>
<span class="line">4. 输入用户名密码 → 进入桌面（不是 login shell）</span>
<span class="line">5. 打开终端应用</span>
<span class="line">   ↓</span>
<span class="line">   加载 /etc/bash.bashrc（系统配置）</span>
<span class="line">   加载 ~/.bashrc（用户配置）</span>
<span class="line">   ↓</span>
<span class="line">   ❌ /etc/profile 和 ~/.profile 不会加载</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>结论：</strong> 桌面用户在打开终端时，只有 <code>/etc/bash.bashrc</code> 和 <code>~/.bashrc</code> 生效</p><hr><h3 id="场景-b-虚拟机或服务器-tty-登录" tabindex="-1"><a class="header-anchor" href="#场景-b-虚拟机或服务器-tty-登录"><span>场景 B：虚拟机或服务器 TTY 登录</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">1. 开机</span>
<span class="line">2. 显示 TTY 登录界面（真正的 login shell）</span>
<span class="line">3. 输入用户名密码</span>
<span class="line">   ↓</span>
<span class="line">   加载 /etc/profile（系统全局配置）</span>
<span class="line">   加载 ~/.profile（用户配置）</span>
<span class="line">   加载 /etc/bash.bashrc（bash 特定配置）</span>
<span class="line">   加载 ~/.bashrc（用户 bash 配置）</span>
<span class="line">   ↓</span>
<span class="line">   ✅ 所有配置都加载</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>结论：</strong> 服务器登录时，所有配置文件都会按顺序加载</p><hr><h3 id="场景-c-ssh-远程登录" tabindex="-1"><a class="header-anchor" href="#场景-c-ssh-远程登录"><span>场景 C：SSH 远程登录</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">1. SSH 连接到服务器</span>
<span class="line">2. 启动 login shell</span>
<span class="line">   ↓</span>
<span class="line">   加载 /etc/profile</span>
<span class="line">   加载 ~/.profile</span>
<span class="line">   加载 /etc/bash.bashrc</span>
<span class="line">   加载 ~/.bashrc</span>
<span class="line">   ↓</span>
<span class="line">   ✅ 所有配置都加载</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>结论：</strong> SSH 登录和 TTY 登录一样，都是 login shell</p><hr><h2 id="四、环境变量生效时机对照表" tabindex="-1"><a class="header-anchor" href="#四、环境变量生效时机对照表"><span>四、环境变量生效时机对照表</span></a></h2><h3 id="对于图形界面用户-ubuntu-22-桌面" tabindex="-1"><a class="header-anchor" href="#对于图形界面用户-ubuntu-22-桌面"><span>对于图形界面用户（Ubuntu 22 桌面）</span></a></h3><table><thead><tr><th>配置位置</th><th>开机后</th><th>打开终端后</th><th>在终端执行 <code>bash</code></th><th>SSH 登录</th></tr></thead><tbody><tr><td><code>/etc/profile</code></td><td>❌</td><td>❌</td><td>❌</td><td>✅</td></tr><tr><td><code>/etc/bash.bashrc</code></td><td>❌</td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td><code>~/.bashrc</code></td><td>❌</td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td><code>~/.profile</code></td><td>❌</td><td>❌</td><td>❌</td><td>✅</td></tr></tbody></table><h3 id="对于服务器用户-tty-或-ssh" tabindex="-1"><a class="header-anchor" href="#对于服务器用户-tty-或-ssh"><span>对于服务器用户（TTY 或 SSH）</span></a></h3><table><thead><tr><th>配置位置</th><th>登录时</th><th>再打开新 bash</th><th>SSH 登录</th></tr></thead><tbody><tr><td><code>/etc/profile</code></td><td>✅</td><td>❌</td><td>✅</td></tr><tr><td><code>/etc/bash.bashrc</code></td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td><code>~/.bashrc</code></td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td><code>~/.profile</code></td><td>✅</td><td>❌</td><td>✅</td></tr></tbody></table><hr><h2 id="五、环境变量的作用示例" tabindex="-1"><a class="header-anchor" href="#五、环境变量的作用示例"><span>五、环境变量的作用示例</span></a></h2><h3 id="java-home-的作用" tabindex="-1"><a class="header-anchor" href="#java-home-的作用"><span>JAVA_HOME 的作用</span></a></h3><p><strong>设置：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/usr/local/jdk-17/jdk-17.0.7</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>应用程序如何使用它：</strong></p><ol><li><p><strong>Tomcat、Maven、Gradle 等工具会读取它</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 这些工具内部会这样调用 Java</span></span>
<span class="line"><span class="token variable">$JAVA_HOME</span>/bin/java</span>
<span class="line"><span class="token variable">$JAVA_HOME</span>/bin/javac</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>快速切换 Java 版本</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 改变 JAVA_HOME 就能切换版本，不需要改 PATH</span></span>
<span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/usr/local/jdk-8     <span class="token comment"># 切到 JDK 8</span></span>
<span class="line"><span class="token function">java</span> <span class="token parameter variable">-version</span></span>
<span class="line"></span>
<span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/usr/local/jdk-17    <span class="token comment"># 切到 JDK 17</span></span>
<span class="line"><span class="token function">java</span> <span class="token parameter variable">-version</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>某些应用启动失败的原因</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">tomcat/bin/startup.sh</span>
<span class="line"><span class="token comment"># Error: JAVA_HOME is not set  ← 没有配置 JAVA_HOME</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="gopath-的作用" tabindex="-1"><a class="header-anchor" href="#gopath-的作用"><span>GOPATH 的作用</span></a></h3><p><strong>设置：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable">GOPATH</span><span class="token operator">=</span><span class="token environment constant">$HOME</span>/go <span class="token comment">#对于新版本的go v1.11+ 之后不需要这样设置, GOPATH默认就是这个</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>Go 如何使用它：</strong></p><ol><li><p><strong>存储依赖包的位置</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">$GOPATH/</span>
<span class="line">├── bin/      (go install 的可执行文件)</span>
<span class="line">├── pkg/      (依赖包)</span>
<span class="line">└── src/      (项目源代码)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>查找导入的包</strong></p><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token string">&quot;github.com/some/package&quot;</span></span>
<span class="line"><span class="token comment">// Go 会在 $GOPATH/pkg/mod 下查找这个包</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>新旧版本对比</strong></p></li></ol><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line"># 旧版本 Go（&lt;1.11）</span>
<span class="line"># 必须设置 GOPATH，所有项目都在 $GOPATH/src 下</span>
<span class="line">export GOPATH=$HOME/go  # ❌ 必须手动设置</span>
<span class="line"></span>
<span class="line"># 新版本 Go（1.11+）</span>
<span class="line"># 引入 go.mod，项目可以放在任何地方</span>
<span class="line"># GOPATH 有默认值，不需要手动配置</span>
<span class="line"># 默认值：$HOME/go（在 Linux/Mac）</span>
<span class="line">export GOPATH=$HOME/go  # ✅ 可选，有默认值</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"># ✅ 新项目：不需要 export GOPATH，直接用 go.mod</span>
<span class="line">cd ~/my-project</span>
<span class="line">go mod init github.com/user/my-project #关于go mod的使用参考: https://go.dev/ref/mod</span>
<span class="line">go build</span>
<span class="line"></span>
<span class="line"># ❌ 不用再像旧版本这样：</span>
<span class="line"># export GOPATH=$HOME/go</span>
<span class="line"># cd $GOPATH/src</span>
<span class="line"># mkdir -p github.com/user/my-project</span>
<span class="line"># cd github.com/user/my-project</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="path-的作用" tabindex="-1"><a class="header-anchor" href="#path-的作用"><span>PATH 的作用</span></a></h3><p><strong>设置：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span><span class="token builtin class-name">:</span><span class="token variable">$JAVA_HOME</span>/bin:<span class="token variable">$GOPATH</span>/bin</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>系统如何使用它：</strong></p><ol><li><p><strong>快速执行命令，不需要完整路径</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 有 PATH 配置</span></span>
<span class="line"><span class="token function">java</span> <span class="token parameter variable">-version</span>    <span class="token comment"># 系统自动在 $PATH 中查找 java</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 没有 PATH 配置</span></span>
<span class="line">/usr/local/jdk-17/jdk-17.0.7/bin/java <span class="token parameter variable">-version</span>  <span class="token comment"># 必须写完整路径</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>命令搜索顺序</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># PATH 中的目录按顺序搜索，找到第一个就执行</span></span>
<span class="line"><span class="token comment"># 如果有多个 java，会执行最前面的那个</span></span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token environment constant">$PATH</span>  <span class="token comment"># 查看搜索顺序</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><hr><h2 id="六、最佳实践" tabindex="-1"><a class="header-anchor" href="#六、最佳实践"><span>六、最佳实践</span></a></h2><h3 id="✅-推荐-个人电脑用户-ubuntu-22-桌面" tabindex="-1"><a class="header-anchor" href="#✅-推荐-个人电脑用户-ubuntu-22-桌面"><span>✅ 推荐：个人电脑用户（Ubuntu 22 桌面）</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 只需在 ~/.bashrc 中配置即可</span></span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token string">&#39;export JAVA_HOME=/usr/local/jdk-17/jdk-17.0.7&#39;</span> <span class="token operator">&gt;&gt;</span> ~/.bashrc</span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token string">&#39;export GOPATH=$HOME/go&#39;</span> <span class="token operator">&gt;&gt;</span> ~/.bashrc</span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token string">&#39;export PATH=$PATH:$JAVA_HOME/bin:$GOPATH/bin&#39;</span> <span class="token operator">&gt;&gt;</span> ~/.bashrc</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 重新加载配置</span></span>
<span class="line"><span class="token builtin class-name">source</span> ~/.bashrc</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 验证</span></span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token variable">$JAVA_HOME</span></span>
<span class="line"><span class="token function">java</span> <span class="token parameter variable">-version</span></span>
<span class="line">go <span class="token function">env</span> GOPATH</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>优势：</strong></p><ul><li>✅ 在所有打开的终端中都生效</li><li>✅ 不需要重新登录</li><li>✅ 不污染系统配置</li><li>✅ 用户独立维护</li></ul><h3 id="⚠️-避免-不要在系统级文件中放用户配置" tabindex="-1"><a class="header-anchor" href="#⚠️-避免-不要在系统级文件中放用户配置"><span>⚠️ 避免：不要在系统级文件中放用户配置</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># ❌ 不要这样做</span></span>
<span class="line"><span class="token comment"># /etc/bash.bashrc 或 /etc/profile</span></span>
<span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable">GOPATH</span><span class="token operator">=</span>/home/qinhong/go  <span class="token comment"># 硬编码用户名</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>问题：</strong></p><ul><li>❌ 其他用户的路径错误</li><li>❌ 用户很难覆盖（如你之前遇到的问题）</li><li>❌ 维护困难</li></ul><h3 id="i️-系统级配置的合理使用" tabindex="-1"><a class="header-anchor" href="#i️-系统级配置的合理使用"><span>ℹ️ 系统级配置的合理使用</span></a></h3><table><thead><tr><th>配置内容</th><th>位置</th><th>原因</th></tr></thead><tbody><tr><td>系统 JDK、Python 等开发工具</td><td><code>/etc/profile</code></td><td>服务器环境，所有用户都可能用</td></tr><tr><td>系统代理、SSL 证书</td><td><code>/etc/profile</code></td><td>系统级需求</td></tr><tr><td>bash 默认行为设置</td><td><code>/etc/bash.bashrc</code></td><td>影响所有 bash 用户</td></tr><tr><td>用户个人路径、密钥</td><td><code>~/.bashrc</code></td><td>仅当前用户，隐私考虑</td></tr></tbody></table><hr><h2 id="七、优先级和覆盖规则" tabindex="-1"><a class="header-anchor" href="#七、优先级和覆盖规则"><span>七、优先级和覆盖规则</span></a></h2><p><strong>加载顺序（从先到后）：</strong></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">Login shell 情况下:</span>
<span class="line">  1. /etc/profile</span>
<span class="line">  2. ~/.profile</span>
<span class="line">  3. /etc/bash.bashrc</span>
<span class="line">  4. ~/.bashrc</span>
<span class="line"></span>
<span class="line">Non-login shell 情况下:</span>
<span class="line">  1. /etc/bash.bashrc</span>
<span class="line">  2. ~/.bashrc</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>覆盖规则：</strong> 后加载的配置会覆盖先加载的相同变量</p><p><strong>例子：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># /etc/bash.bashrc</span></span>
<span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable">GOPATH</span><span class="token operator">=</span>/usr/local/go-project</span>
<span class="line"></span>
<span class="line"><span class="token comment"># ~/.bashrc</span></span>
<span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable">GOPATH</span><span class="token operator">=</span><span class="token environment constant">$HOME</span>/go</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>最终结果：</strong> <code>GOPATH=$HOME/go</code>（用户配置覆盖系统配置）</p><hr><h2 id="八、排查问题的方法" tabindex="-1"><a class="header-anchor" href="#八、排查问题的方法"><span>八、排查问题的方法</span></a></h2><h3 id="检查环境变量来源" tabindex="-1"><a class="header-anchor" href="#检查环境变量来源"><span>检查环境变量来源</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 查看当前的值</span></span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token variable">$JAVA_HOME</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 搜索哪些文件设置了这个变量</span></span>
<span class="line"><span class="token function">grep</span> <span class="token parameter variable">-r</span> <span class="token string">&quot;JAVA_HOME&quot;</span> /etc/ ~/ <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 用调试模式看加载过程</span></span>
<span class="line"><span class="token function">bash</span> <span class="token parameter variable">-x</span> ~/.bashrc <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-20</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="强制清除配置" tabindex="-1"><a class="header-anchor" href="#强制清除配置"><span>强制清除配置</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 从文件中删除</span></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;/JAVA_HOME/d&#39;</span> /etc/bash.bashrc</span>
<span class="line"><span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;/JAVA_HOME/d&#39;</span> ~/.bashrc</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 当前 shell 中临时清除</span></span>
<span class="line"><span class="token builtin class-name">unset</span> JAVA_HOME</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 验证</span></span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token variable">$JAVA_HOME</span>  <span class="token comment"># 应该为空</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="检查是否是-login-shell" tabindex="-1"><a class="header-anchor" href="#检查是否是-login-shell"><span>检查是否是 login shell</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 如果输出 -bash，说明是 login shell</span></span>
<span class="line"><span class="token comment"># 如果输出 bash，说明是非 login shell</span></span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token variable">$0</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 或者</span></span>
<span class="line"><span class="token builtin class-name">shopt</span> login_shells</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="九、你的具体情况总结" tabindex="-1"><a class="header-anchor" href="#九、你的具体情况总结"><span>九、你的具体情况总结</span></a></h2><p><strong>问题原因：</strong></p><ol><li>GOPATH 配置在 <code>/etc/bash.bashrc</code>（系统级）</li><li>尝试用 <code>go env -w</code> 在用户级覆盖</li><li>但系统级配置加载顺序在前，每次 bash 启动都重新加载</li><li>导致用户级配置被覆盖</li></ol><p><strong>解决方案：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 1. 删除系统级配置</span></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;/GOPATH/d&#39;</span> /etc/bash.bashrc</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;/GOPATH/d&#39;</span> /etc/profile</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 2. 在 ~/.bashrc 中添加</span></span>
<span class="line"><span class="token function">cat</span> <span class="token operator">&gt;&gt;</span> ~/.bashrc <span class="token operator">&lt;&lt;</span> <span class="token string">&#39;EOF&#39;</span>
<span class="line">export GOPATH=$HOME/go</span>
<span class="line">export GOMODCACHE=$HOME/go/pkg/mod</span>
<span class="line">export PATH=$PATH:$GOPATH/bin</span>
<span class="line">EOF</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 3. 重新加载</span></span>
<span class="line"><span class="token builtin class-name">source</span> ~/.bashrc</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 4. 验证</span></span>
<span class="line">go <span class="token function">env</span> GOPATH</span>
<span class="line">go <span class="token function">env</span> GOMODCACHE</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>验证结果：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">$ go <span class="token function">env</span> GOPATH</span>
<span class="line">/home/qinhong/go</span>
<span class="line"></span>
<span class="line">$ go <span class="token function">env</span> <span class="token parameter variable">-w</span> <span class="token assign-left variable">GOPATH</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>  <span class="token comment"># 现在应该能成功</span></span>
<span class="line"><span class="token comment"># 无 warning</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="最后补充一个关于环境变量生效的问题" tabindex="-1"><a class="header-anchor" href="#最后补充一个关于环境变量生效的问题"><span>最后补充一个关于环境变量生效的问题</span></a></h2><p>突然想到一个问题，默认是 GOPATH=$HOME/go 如果我执行</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">export GOPATH=/usr/local/go-project</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>这个export 会被写在哪里 会一直生效吗</p><p>分析: <strong><code>export</code> 命令的作用：</strong></p><p><code>export GOPATH=/usr/local/go-project</code> 只会在<strong>当前 shell 会话</strong>中生效。</p><p><strong>具体流程：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 1. 你在终端输入命令</span></span>
<span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable">GOPATH</span><span class="token operator">=</span>/usr/local/go-project</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 2. 这个命令被解析，变量被设置到当前 shell 的内存中</span></span>
<span class="line"><span class="token comment"># ✅ 当前终端生效</span></span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token variable">$GOPATH</span>  <span class="token comment"># 输出 /usr/local/go-project</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 3. 你关闭终端或退出 shell</span></span>
<span class="line"><span class="token comment"># ❌ 变量从内存中删除</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 4. 打开新的终端窗口</span></span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token variable">$GOPATH</span>  <span class="token comment"># 输出 /home/qinhong/go（回到默认值）</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>关键点：</strong> <code>export</code> 只修改内存，不写入任何文件</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">export GOPATH=/usr/local/go-project</span>
<span class="line">         ↓</span>
<span class="line">    写到内存</span>
<span class="line">         ↓</span>
<span class="line">当前 shell 进程中生效</span>
<span class="line">         ↓</span>
<span class="line">shell 关闭 → 内存释放 → 失效</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><p><strong>如果想要永久生效，必须写入配置文件：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># ✅ 正确做法：写入配置文件</span></span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token string">&#39;export GOPATH=/usr/local/go-project&#39;</span> <span class="token operator">&gt;&gt;</span> ~/.bashrc</span>
<span class="line"><span class="token builtin class-name">source</span> ~/.bashrc</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 或者直接编辑</span></span>
<span class="line"><span class="token function">vim</span> ~/.bashrc</span>
<span class="line"><span class="token comment"># 添加一行：export GOPATH=/usr/local/go-project</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>验证写入成功：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 查看配置文件</span></span>
<span class="line"><span class="token function">cat</span> ~/.bashrc <span class="token operator">|</span> <span class="token function">grep</span> GOPATH</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 关闭终端，打开新的</span></span>
<span class="line"><span class="token comment"># 新终端中：</span></span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token variable">$GOPATH</span>  <span class="token comment"># 应该显示 /usr/local/go-project</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><p><strong>命令行 export vs 配置文件的区别：</strong></p><table><thead><tr><th>方式</th><th>写入位置</th><th>生效范围</th><th>持久性</th></tr></thead><tbody><tr><td><code>export GOPATH=...</code></td><td>内存</td><td>当前 shell</td><td>❌ 仅当前会话</td></tr><tr><td>写入 <code>~/.bashrc</code></td><td>磁盘文件</td><td>所有新 bash</td><td>✅ 永久有效</td></tr><tr><td>写入 <code>/etc/bash.bashrc</code></td><td>磁盘文件</td><td>所有用户的 bash</td><td>✅ 永久有效</td></tr></tbody></table><hr><p><strong>实际测试：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 终端 1</span></span>
<span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable">GOPATH</span><span class="token operator">=</span>/usr/local/go-project</span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token variable">$GOPATH</span>  <span class="token comment"># /usr/local/go-project</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 打开新的终端窗口（终端 2）</span></span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token variable">$GOPATH</span>  <span class="token comment"># /home/qinhong/go（默认值！）</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 回到终端 1</span></span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token variable">$GOPATH</span>  <span class="token comment"># /usr/local/go-project（仍然是修改的值）</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><p><strong>你之前的问题也是这个原因：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 尝试用 go env -w 覆盖</span></span>
<span class="line">go <span class="token function">env</span> <span class="token parameter variable">-w</span> <span class="token assign-left variable">GOPATH</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 但系统级的 /etc/bash.bashrc 中有持久化配置</span></span>
<span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable">GOPATH</span><span class="token operator">=</span>/usr/local/go-project  <span class="token comment"># ← 这是写在文件中的</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 每次打开新终端，都会重新加载 /etc/bash.bashrc</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>总结：</strong></p><ul><li><strong>命令行 export</strong> = 临时修改（关闭终端后失效）</li><li><strong>写入配置文件</strong> = 永久修改（每次打开终端都生效）</li></ul>`,117)]))}const d=n(i,[["render",t],["__file","Shell环境变量配置完全指南.html.vue"]]),r=JSON.parse('{"path":"/content/go/base/Shell%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97.html","title":"Shell环境变量配置完全指南","lang":"en-US","frontmatter":{"sidebar":false,"title":"Shell环境变量配置完全指南","head":[["meta",{"name":"title","content":"Shell环境变量配置完全指南"}],["meta",{"name":"description","content":"Shell环境变量配置完全指南"}],["meta",{"name":"keywords","content":"Shell环境变量配置完全指南"}],["meta",{"property":"og:title","content":"Shell环境变量配置完全指南"}],["meta",{"property":"og:description","content":"Shell环境变量配置完全指南"}]]},"headers":[{"level":2,"title":"一、配置文件概览","slug":"一、配置文件概览","link":"#一、配置文件概览","children":[]},{"level":2,"title":"二、Shell 类型详解","slug":"二、shell-类型详解","link":"#二、shell-类型详解","children":[{"level":3,"title":"Login Shell（登录 shell）","slug":"login-shell-登录-shell","link":"#login-shell-登录-shell","children":[]},{"level":3,"title":"Non-login Shell（非登录 shell）","slug":"non-login-shell-非登录-shell","link":"#non-login-shell-非登录-shell","children":[]}]},{"level":2,"title":"三、详细加载流程","slug":"三、详细加载流程","link":"#三、详细加载流程","children":[{"level":3,"title":"场景 A：Ubuntu 22 图形界面开机（最常见）","slug":"场景-a-ubuntu-22-图形界面开机-最常见","link":"#场景-a-ubuntu-22-图形界面开机-最常见","children":[]},{"level":3,"title":"场景 B：虚拟机或服务器 TTY 登录","slug":"场景-b-虚拟机或服务器-tty-登录","link":"#场景-b-虚拟机或服务器-tty-登录","children":[]},{"level":3,"title":"场景 C：SSH 远程登录","slug":"场景-c-ssh-远程登录","link":"#场景-c-ssh-远程登录","children":[]}]},{"level":2,"title":"四、环境变量生效时机对照表","slug":"四、环境变量生效时机对照表","link":"#四、环境变量生效时机对照表","children":[{"level":3,"title":"对于图形界面用户（Ubuntu 22 桌面）","slug":"对于图形界面用户-ubuntu-22-桌面","link":"#对于图形界面用户-ubuntu-22-桌面","children":[]},{"level":3,"title":"对于服务器用户（TTY 或 SSH）","slug":"对于服务器用户-tty-或-ssh","link":"#对于服务器用户-tty-或-ssh","children":[]}]},{"level":2,"title":"五、环境变量的作用示例","slug":"五、环境变量的作用示例","link":"#五、环境变量的作用示例","children":[{"level":3,"title":"JAVA_HOME 的作用","slug":"java-home-的作用","link":"#java-home-的作用","children":[]},{"level":3,"title":"GOPATH 的作用","slug":"gopath-的作用","link":"#gopath-的作用","children":[]},{"level":3,"title":"PATH 的作用","slug":"path-的作用","link":"#path-的作用","children":[]}]},{"level":2,"title":"六、最佳实践","slug":"六、最佳实践","link":"#六、最佳实践","children":[{"level":3,"title":"✅ 推荐：个人电脑用户（Ubuntu 22 桌面）","slug":"✅-推荐-个人电脑用户-ubuntu-22-桌面","link":"#✅-推荐-个人电脑用户-ubuntu-22-桌面","children":[]},{"level":3,"title":"⚠️ 避免：不要在系统级文件中放用户配置","slug":"⚠️-避免-不要在系统级文件中放用户配置","link":"#⚠️-避免-不要在系统级文件中放用户配置","children":[]},{"level":3,"title":"ℹ️ 系统级配置的合理使用","slug":"i️-系统级配置的合理使用","link":"#i️-系统级配置的合理使用","children":[]}]},{"level":2,"title":"七、优先级和覆盖规则","slug":"七、优先级和覆盖规则","link":"#七、优先级和覆盖规则","children":[]},{"level":2,"title":"八、排查问题的方法","slug":"八、排查问题的方法","link":"#八、排查问题的方法","children":[{"level":3,"title":"检查环境变量来源","slug":"检查环境变量来源","link":"#检查环境变量来源","children":[]},{"level":3,"title":"强制清除配置","slug":"强制清除配置","link":"#强制清除配置","children":[]},{"level":3,"title":"检查是否是 login shell","slug":"检查是否是-login-shell","link":"#检查是否是-login-shell","children":[]}]},{"level":2,"title":"九、你的具体情况总结","slug":"九、你的具体情况总结","link":"#九、你的具体情况总结","children":[]},{"level":2,"title":"最后补充一个关于环境变量生效的问题","slug":"最后补充一个关于环境变量生效的问题","link":"#最后补充一个关于环境变量生效的问题","children":[]}],"git":{},"filePathRelative":"content/go/base/Shell环境变量配置完全指南.md"}');export{d as comp,r as data};
