import{_ as H,g as i,l as M,o as p,c as f,b as s,C as k,D as x,t as y,F as W,m as q,k as _,h as C,j as G,N as Q,M as R,z as X}from"./app-BB_BIQV8.js";import{C as b,F as P,J as z}from"./jszip.min-ZwSeMA6g.js";import"./commonjsHelpers-BosuxZz1.js";import"./vite-browser-external_commonjs-proxy-wZpHG6Gx.js";const Y={__name:"PdfDecryptor",setup(I,{expose:n}){n();const r=i([]),e=i([]),w=i(""),A=i(!1),a=i(!1),g=i(""),D=i(""),S=i(!1),J=i(null),m=i(0),N=M(()=>!a.value||r.value.length===0?0:m.value/r.value.length*100);function U(t){S.value=!1;const l=Array.from(t.dataTransfer.files).filter(o=>o.name.endsWith(".enc"));if(l.length===0){c("è¯·ä¸Šä¼  .enc æ ¼å¼çš„æ–‡ä»¶","error");return}F(l)}function V(t){const l=Array.from(t.target.files);F(l)}function F(t){const l=t.map(o=>({file:o,name:o.name,status:"pending"}));r.value=[...r.value,...l],c(`å·²æ·»åŠ  ${t.length} ä¸ªæ–‡ä»¶`,"success")}function j(t){r.value.splice(t,1),r.value.length===0&&(e.value=[])}function O(){r.value=[],e.value=[],w.value="",g.value=""}function K(t){return{pending:"â³ å¾…è§£å¯†",decrypting:"ğŸ”„ è§£å¯†ä¸­",success:"âœ… æˆåŠŸ",error:"âŒ å¤±è´¥"}[t]||""}function c(t,l="info"){g.value=t,D.value=l,setTimeout(()=>{g.value=""},4e3)}function T(t,l){try{const o=b.AES.decrypt(t,l,{mode:b.mode.CBC,padding:b.pad.Pkcs7}),d=o.words,u=o.sigBytes;if(!d||u===0)throw new Error("è§£å¯†ç»“æœä¸ºç©º");const h=new Uint8Array(u);for(let v=0;v<u;v++)h[v]=d[v>>>2]>>>24-v%4*8&255;return h}catch{throw new Error("è§£å¯†å¤±è´¥ï¼Œå¯†ç å¯èƒ½ä¸æ­£ç¡®")}}function E(t){const l=new Uint8Array([37,80,68,70,45]);if(t.length<5)return!1;for(let o=0;o<5;o++)if(t[o]!==l[o])return!1;return!0}async function L(){a.value=!0,m.value=0,e.value=[];let t=0,l=0;for(let o=0;o<r.value.length;o++){const d=r.value[o];d.status="decrypting";try{const u=await d.file.text(),h=T(u,w.value);if(!E(h))throw new Error("å¯†ç é”™è¯¯ï¼šè§£å¯†åçš„æ–‡ä»¶ä¸æ˜¯æœ‰æ•ˆçš„ PDF æ ¼å¼");const v=d.name.replace(/\.enc$/,"");d.status="success",e.value.push({name:v,data:h}),t++}catch(u){console.error(`è§£å¯† ${d.name} å¤±è´¥:`,u),d.status="error",l++}m.value=o+1,await new Promise(u=>setTimeout(u,100))}a.value=!1,m.value=0,t>0&&l===0?c(`ğŸ‰ æˆåŠŸè§£å¯† ${t} ä¸ªæ–‡ä»¶ï¼`,"success"):t>0&&l>0?c(`âš ï¸ æˆåŠŸ ${t} ä¸ªï¼Œå¤±è´¥ ${l} ä¸ªï¼ˆè¯·æ£€æŸ¥å¯†ç ï¼‰`,"warning"):c("âŒ è§£å¯†å¤±è´¥ï¼å¯†ç é”™è¯¯æˆ–æ–‡ä»¶å·²æŸå","error")}async function Z(){if(e.value.length!==0)if(c("æ­£åœ¨å‡†å¤‡ä¸‹è½½...","info"),e.value.length===1){const t=e.value[0],l=new Blob([t.data],{type:"application/pdf"});P.saveAs(l,t.name),c("âœ… æ–‡ä»¶å·²ä¸‹è½½","success")}else{const t=new z;e.value.forEach(o=>{t.file(o.name,o.data)});const l=await t.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:9}});P.saveAs(l,`decrypted_pdfs_${Date.now()}.zip`),c(`âœ… å·²æ‰“åŒ…ä¸‹è½½ ${e.value.length} ä¸ªæ–‡ä»¶`,"success")}}const B={files:r,decryptedFiles:e,password:w,showPassword:A,processing:a,message:g,messageType:D,isDragging:S,fileInput:J,currentProgress:m,progress:N,handleDrop:U,handleUpload:V,addFiles:F,removeFile:j,clearAll:O,getStatusText:K,showMessage:c,decryptFile:T,isPDFValid:E,decryptFiles:L,downloadAll:Z,ref:i,computed:M,get CryptoJS(){return b},get saveAs(){return P.saveAs},get JSZip(){return z}};return Object.defineProperty(B,"__isScriptSetup",{enumerable:!1,value:!0}),B}},$={class:"pdf-decryptor"},ee={key:0,class:"file-list"},se={class:"list-header"},te={class:"file-info"},ne={class:"file-name"},le={class:"file-actions"},oe=["onClick"],ae={class:"input-group"},re={class:"password-input"},ie=["type"],ce={class:"button-group"},de=["disabled"],ue={key:0},pe={key:1},fe={key:1,class:"progress-bar"},ge={class:"progress-text"};function ve(I,n,r,e,w,A){return p(),f("div",$,[n[7]||(n[7]=s("h2",{class:"title"},"ğŸ”“ PDF è§£å¯†å·¥å…·",-1)),n[8]||(n[8]=s("p",{class:"subtitle"},"è§£å¯†é€šè¿‡åŠ å¯†å·¥å…·ç”Ÿæˆçš„ .enc æ–‡ä»¶",-1)),s("div",{class:k(["upload-area",{"drag-over":e.isDragging}]),onDrop:x(e.handleDrop,["prevent"]),onDragover:n[0]||(n[0]=x(a=>e.isDragging=!0,["prevent"])),onDragleave:n[1]||(n[1]=x(a=>e.isDragging=!1,["prevent"]))},[s("input",{type:"file",accept:".enc",multiple:"",onChange:e.handleUpload,id:"encInput",ref:"fileInput",hidden:""},null,544),n[4]||(n[4]=s("div",{class:"upload-content"},[s("div",{class:"upload-icon"},"ğŸ“"),s("label",{for:"encInput",class:"upload-btn"},"é€‰æ‹© .enc æ–‡ä»¶"),s("p",{class:"upload-hint"},"æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„")],-1))],34),e.files.length?(p(),f("div",ee,[s("div",se,[s("span",null,"æ–‡ä»¶åˆ—è¡¨ ("+y(e.files.length)+")",1),s("button",{class:"clear-btn",onClick:e.clearAll},"æ¸…ç©º")]),(p(!0),f(W,null,q(e.files,(a,g)=>(p(),f("div",{key:g,class:"file-item"},[s("div",te,[n[5]||(n[5]=s("span",{class:"file-icon"},"ğŸ“„",-1)),s("span",ne,y(a.name),1)]),s("div",le,[s("span",{class:k(["status",a.status])},y(e.getStatusText(a.status)),3),s("button",{class:"delete-btn",onClick:D=>e.removeFile(g)},"âœ•",8,oe)])]))),128))])):_("",!0),s("div",ae,[n[6]||(n[6]=s("label",null,[s("span",{class:"label-icon"},"ğŸ”‘"),C(" è§£å¯†å¯†ç ï¼š ")],-1)),s("div",re,[G(s("input",{"onUpdate:modelValue":n[2]||(n[2]=a=>e.password=a),type:e.showPassword?"text":"password",placeholder:"è¯·è¾“å…¥åŠ å¯†æ—¶ä½¿ç”¨çš„å¯†ç ",onKeyup:R(e.decryptFiles,["enter"])},null,40,ie),[[Q,e.password]]),s("button",{class:"toggle-password",onClick:n[3]||(n[3]=a=>e.showPassword=!e.showPassword)},y(e.showPassword?"ğŸ‘ï¸":"ğŸ‘ï¸â€ğŸ—¨ï¸"),1)])]),s("div",ce,[s("button",{class:"decrypt-btn",disabled:!e.files.length||!e.password||e.processing,onClick:e.decryptFiles},[e.processing?(p(),f("span",ue,"â³ è§£å¯†ä¸­...")):(p(),f("span",pe,"ğŸ”“ è§£å¯†æ–‡ä»¶"))],8,de),e.decryptedFiles.length>0?(p(),f("button",{key:0,class:"download-all-btn",onClick:e.downloadAll},[s("span",null,"ğŸ’¾ ä¸‹è½½å…¨éƒ¨ ("+y(e.decryptedFiles.length)+")",1)])):_("",!0)]),e.processing?(p(),f("div",fe,[s("div",{class:"progress-fill",style:X({width:e.progress+"%"})},null,4),s("span",ge,y(Math.round(e.progress))+"%",1)])):_("",!0),e.message?(p(),f("div",{key:2,class:k(["message",e.messageType])},y(e.message),3)):_("",!0),n[9]||(n[9]=s("div",{class:"instructions"},[s("details",null,[s("summary",null,"ğŸ“– ä½¿ç”¨è¯´æ˜"),s("ol",null,[s("li",null,[C("ä¸Šä¼ ä»åŠ å¯†å·¥å…·ç”Ÿæˆçš„ "),s("code",null,".enc"),C(" æ–‡ä»¶")]),s("li",null,"è¾“å…¥åŠ å¯†æ—¶ä½¿ç”¨çš„å¯†ç "),s("li",null,'ç‚¹å‡»"è§£å¯†æ–‡ä»¶"æŒ‰é’®'),s("li",null,'è§£å¯†æˆåŠŸåï¼Œç‚¹å‡»"ä¸‹è½½å…¨éƒ¨"è·å–åŸå§‹ PDF')]),s("p",{class:"note"},"ğŸ’¡ æ”¯æŒæ‰¹é‡è§£å¯†ï¼Œä¸€æ¬¡å¯å¤„ç†å¤šä¸ªæ–‡ä»¶")])],-1))])}const _e=H(Y,[["render",ve],["__scopeId","data-v-a68a4a70"],["__file","PdfDecryptor.vue"]]);export{_e as default};
