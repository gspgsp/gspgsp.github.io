import{_ as s,c as a,f as e,o as t}from"./app-BB_BIQV8.js";const p={};function l(i,n){return t(),a("div",null,n[0]||(n[0]=[e(`<h5 id="symfony7ä¹‹getsinglescalarresultæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#symfony7ä¹‹getsinglescalarresultæ–¹æ³•"><span>symfony7ä¹‹getSingleScalarResultæ–¹æ³•</span></a></h5><p><code>getSingleScalarResult()</code> æ˜¯ Doctrine ä¸­ <code>Query</code> å¯¹è±¡çš„æ–¹æ³•ä¹‹ä¸€ï¼Œç”¨äº<strong>è¿”å›æŸ¥è¯¢ç»“æœä¸­çš„å•ä¸ªæ ‡é‡å€¼</strong>ï¼Œæ¯”å¦‚ï¼š</p><ul><li>ä¸€ä¸ªæ•´æ•°æ•°é‡ï¼ˆå¦‚ <code>COUNT()</code> çš„ç»“æœï¼‰ï¼›</li><li>ä¸€ä¸ªå•ä¸ªå­—æ®µçš„å€¼ï¼ˆæ¯”å¦‚ <code>MAX(price)</code>ï¼‰ï¼›</li></ul><hr><h3 id="âœ…-å¸¸è§ç”¨æ³•åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#âœ…-å¸¸è§ç”¨æ³•åœºæ™¯"><span>âœ… å¸¸è§ç”¨æ³•åœºæ™¯</span></a></h3><h4 id="_1-count" tabindex="-1"><a class="header-anchor" href="#_1-count"><span>1. <code>COUNT(...)</code></span></a></h4><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token variable">$count</span> <span class="token operator">=</span> <span class="token variable">$qb</span></span>
<span class="line">    <span class="token operator">-&gt;</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;COUNT(o.id)&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token operator">-&gt;</span><span class="token function">getQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token operator">-&gt;</span><span class="token function">getSingleScalarResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿”å›çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œéœ€è¦æ‰‹åŠ¨å¼ºè½¬ä¸º <code>int</code>ï¼š</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token punctuation">(</span><span class="token keyword type-casting">int</span><span class="token punctuation">)</span> <span class="token variable">$count</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><hr><h4 id="_2-sum-max-min" tabindex="-1"><a class="header-anchor" href="#_2-sum-max-min"><span>2. <code>SUM(...)</code> / <code>MAX(...)</code> / <code>MIN(...)</code></span></a></h4><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token variable">$sum</span> <span class="token operator">=</span> <span class="token variable">$qb</span></span>
<span class="line">    <span class="token operator">-&gt;</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;SUM(o.amount)&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token operator">-&gt;</span><span class="token function">getQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token operator">-&gt;</span><span class="token function">getSingleScalarResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿”å› stringï¼Œä¾‹å¦‚ &#39;1234.50&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="âš ï¸-æ³¨æ„äº‹é¡¹" tabindex="-1"><a class="header-anchor" href="#âš ï¸-æ³¨æ„äº‹é¡¹"><span>âš ï¸ æ³¨æ„äº‹é¡¹</span></a></h3><ol><li><p><strong>è¿”å›çš„æ˜¯å­—ç¬¦ä¸²</strong>ï¼ˆæ— è®ºæ˜¯æ•°å­—è¿˜æ˜¯å…¶ä»–ç±»å‹ï¼‰ï¼Œå› æ­¤å¸¸å¸¸éœ€è¦ <code>(int)</code> æˆ– <code>(float)</code> è½¬æ¢ï¼›</p></li><li><p><strong>åªèƒ½ç”¨äºè¿”å›å•ä¸ªç»“æœ</strong>ï¼Œå¦åˆ™æŠ›å‡ºå¼‚å¸¸ï¼š</p><blockquote><p><code>Doctrine\\ORM\\NonUniqueResultException</code></p></blockquote></li></ol><hr><h3 id="ğŸš«-ä¸é€‚ç”¨çš„æƒ…å†µ" tabindex="-1"><a class="header-anchor" href="#ğŸš«-ä¸é€‚ç”¨çš„æƒ…å†µ"><span>ğŸš« ä¸é€‚ç”¨çš„æƒ…å†µï¼š</span></a></h3><p>å¦‚æœä½ æŸ¥è¯¢çš„æ˜¯å¤šåˆ—ã€å¤šè¡Œï¼ˆæ¯”å¦‚åˆ—è¡¨æˆ–å¤šå­—æ®µç»“æ„ï¼‰ï¼Œåº”ä½¿ç”¨ï¼š</p><ul><li><code>getResult()</code> â†’ è¿”å›å¤šè¡Œå¤šåˆ—ï¼ˆæ•°ç»„ï¼‰</li><li><code>getOneOrNullResult()</code> â†’ ä»…ç”¨äºä¸€ä¸ªå®ä½“å¯¹è±¡ï¼ˆæˆ– nullï¼‰</li><li><code>getArrayResult()</code> â†’ è¿”å›æ•°ç»„ç»“æ„</li></ul><hr><h5 id="symfony7å¯¹äº-getsingleresult-çš„ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#symfony7å¯¹äº-getsingleresult-çš„ä½¿ç”¨"><span>symfony7å¯¹äº getSingleResult çš„ä½¿ç”¨</span></a></h5><blockquote><p>åœ¨ Symfony 7ï¼ˆDoctrine ORMï¼‰ä¸­ï¼Œ<code>getSingleResult()</code> <strong>ä»ç„¶ä¼šç”Ÿæ•ˆ</strong>ï¼Œå³ä½¿æ‰§è¡Œçš„æ˜¯ä¸€ä¸ª <code>SELECT COUNT(...)</code>, <code>SUM(...)</code> è¿™æ ·çš„èšåˆæŸ¥è¯¢ï¼Œå¹¶è¿”å›å¤šåˆ—åˆ«åå­—æ®µã€‚</p></blockquote><p>æ¥çœ‹ä¸€ä¸‹è¿™æ®µä»£ç ï¼š</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token operator">-&gt;</span><span class="token function">select</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token string single-quoted-string">&#39;COUNT(p.id) as total&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string double-quoted-string">&quot;SUM(CASE WHEN p.status = :accepted THEN 1 ELSE 0 END) as accepted&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string double-quoted-string">&quot;SUM(CASE WHEN p.status = :rejected THEN 1 ELSE 0 END) as rejected&quot;</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ˜¯ä¸€ä¸ªåªä¼šè¿”å›ä¸€è¡Œç»“æœçš„èšåˆæŸ¥è¯¢ï¼ˆæ²¡æœ‰ <code>GROUP BY</code>ï¼‰, è°ƒç”¨ï¼š</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token variable">$qb</span><span class="token operator">-&gt;</span><span class="token function">getQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getSingleResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å®ƒå°†è¿”å›ä¸€ä¸ª<strong>å…³è”æ•°ç»„</strong>ï¼ˆå¦‚æœä½ ä½¿ç”¨çš„æ˜¯ <code>Query::HYDRATE_ARRAY</code> æˆ–é»˜è®¤çš„ hydrate modeï¼‰ï¼š</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token punctuation">[</span></span>
<span class="line">    <span class="token string single-quoted-string">&#39;total&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;10&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string single-quoted-string">&#39;accepted&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;5&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string single-quoted-string">&#39;rejected&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;1&#39;</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„è¿”å›å€¼ä¸­çš„æ•°å­—æ˜¯å­—ç¬¦ä¸²å½¢å¼ï¼ˆå› ä¸º SQL æŸ¥è¯¢è¿”å›çš„æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼‰ï¼Œæ‰€ä»¥ä½ ç”¨ï¼š</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token keyword">return</span> <span class="token function">array_map</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;intval&#39;</span><span class="token punctuation">,</span> <span class="token variable">$qb</span><span class="token operator">-&gt;</span><span class="token function">getQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getSingleResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æ˜¯<strong>æ­£ç¡®ä¸”å¸¸è§çš„åšæ³•</strong> â€”â€” æŠŠè¿™äº›èšåˆæ•°å€¼å­—æ®µå…¨éƒ¨è½¬ä¸º <code>int</code> ç±»å‹ã€‚</p><p><code>array_map(&#39;intval&#39;, $array)</code> ä¼šå¯¹æ•°ç»„ä¸­ <strong>æ¯ä¸€ä¸ªå€¼</strong> æ‰§è¡Œ <code>intval()</code> è½¬æ¢æ“ä½œï¼Œæ— è®ºé”®åæ˜¯ä»€ä¹ˆï¼ˆé”®åä¼šä¿ç•™ï¼‰ã€‚</p><p>ä¾‹å¦‚ï¼š</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token variable">$data</span> <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token string single-quoted-string">&#39;total&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;10&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string single-quoted-string">&#39;accepted&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;5&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string single-quoted-string">&#39;rejected&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;1&#39;</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">array_map</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;intval&#39;</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œå <code>$result</code> ä¸ºï¼š</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token punctuation">[</span></span>
<span class="line">    <span class="token string single-quoted-string">&#39;total&#39;</span> <span class="token operator">=&gt;</span> <span class="token number">10</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string single-quoted-string">&#39;accepted&#39;</span> <span class="token operator">=&gt;</span> <span class="token number">5</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string single-quoted-string">&#39;rejected&#39;</span> <span class="token operator">=&gt;</span> <span class="token number">1</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="âœ…-æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#âœ…-æ€»ç»“"><span>âœ… æ€»ç»“ï¼š</span></a></h5><ul><li>âœ… ä¼šè½¬æ¢æ¯ä¸ª <strong>å€¼</strong> ä¸ºæ•´æ•°ã€‚</li><li>âœ… é”®åä¸å˜ã€‚</li><li>âŒ ä¸ä¼šå¤„ç†åµŒå¥—æ•°ç»„ï¼ˆåªæ˜¯æµ…å±‚è½¬æ¢ï¼‰ã€‚</li></ul><p>å¦‚æœä½ åªæƒ³è½¬æ¢æŸäº›å­—æ®µï¼Œå¯ä»¥å•ç‹¬å†™ï¼š</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$qb</span><span class="token operator">-&gt;</span><span class="token function">getQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getSingleResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;total&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">int</span><span class="token punctuation">)</span> <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;total&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><hr><h5 id="è¡¥å……è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#è¡¥å……è¯´æ˜"><span>è¡¥å……è¯´æ˜ï¼š</span></a></h5><h5 id="å¦‚æœç”¨çš„æ˜¯-dql-doctrine-query-language" tabindex="-1"><a class="header-anchor" href="#å¦‚æœç”¨çš„æ˜¯-dql-doctrine-query-language"><span>å¦‚æœç”¨çš„æ˜¯ DQLï¼ˆDoctrine Query Languageï¼‰ï¼š</span></a></h5><p><code>getSingleResult()</code> ä¼šè¿”å›ä¸€ä¸ªç´¢å¼•æ•°ç»„æˆ–å¯¹è±¡ï¼Œå–å†³äºä½ çš„ DQL æŸ¥è¯¢å’Œ hydration æ–¹å¼ã€‚</p><h5 id="å¦‚æœä½ æƒ³ç¡®ä¿è¿”å›å…³è”æ•°ç»„" tabindex="-1"><a class="header-anchor" href="#å¦‚æœä½ æƒ³ç¡®ä¿è¿”å›å…³è”æ•°ç»„"><span>å¦‚æœä½ æƒ³ç¡®ä¿è¿”å›å…³è”æ•°ç»„ï¼š</span></a></h5><p>ä½ å¯ä»¥æ˜¾ç¤ºè®¾ç½® hydration mode ä¸º <code>HYDRATE_ARRAY</code>ï¼š</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token keyword">return</span> <span class="token function">array_map</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;intval&#39;</span><span class="token punctuation">,</span> <span class="token variable">$qb</span><span class="token operator">-&gt;</span><span class="token function">getQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getSingleResult</span><span class="token punctuation">(</span><span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\\</span>Doctrine<span class="token punctuation">\\</span>ORM<span class="token punctuation">\\</span>Query</span><span class="token operator">::</span><span class="token constant">HYDRATE_ARRAY</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ä½†åœ¨ä½¿ç”¨ <code>QueryBuilder</code> é»˜è®¤æ˜¯ <code>HYDRATE_ARRAY</code>ï¼Œä½ å†™æ³•å°±å·²ç» OKã€‚</p><hr><p>âœ… <strong>ç»“è®º</strong>ï¼š</p><ul><li><code>getSingleResult()</code> åœ¨ä½ çš„è¿™ä¸ª SQL èšåˆæŸ¥è¯¢ä¸­<strong>æ˜¯ç”Ÿæ•ˆçš„</strong>ï¼Œä¼šè¿”å›ä¸€è¡Œæ•°ç»„ï¼Œ<code>array_map(&#39;intval&#39;, ...)</code> ç”¨äºè½¬æ•´å‹ä¹Ÿå®Œå…¨åˆç†ã€‚å¯ä»¥æ”¾å¿ƒä½¿ç”¨ã€‚</li><li>é€‚ç”¨äºå•è¡Œæ•°æ®ï¼Œè€Œæ— è®ºæ˜¯å•ä¸ªå­—æ®µè¿˜æ˜¯å¤šä¸ªå­—æ®µ</li></ul>`,51)]))}const c=s(p,[["render",l],["__file","symfony7ä¹‹getSingleScalarResultæ–¹æ³•.html.vue"]]),r=JSON.parse('{"path":"/content/php/symfony/symfony7%E4%B9%8BgetSingleScalarResult%E6%96%B9%E6%B3%95.html","title":"symfony7ä¹‹getSingleScalarResultæ–¹æ³•","lang":"en-US","frontmatter":{"sidebar":false,"title":"symfony7ä¹‹getSingleScalarResultæ–¹æ³•","head":[["meta",{"name":"title","content":"symfony7ä¹‹getSingleScalarResultæ–¹æ³•"}],["meta",{"name":"description","content":"symfony7ä¹‹getSingleScalarResultæ–¹æ³•"}],["meta",{"name":"keywords","content":"symfony7"}],["meta",{"property":"og:title","content":"symfony7ä¹‹getSingleScalarResultæ–¹æ³•"}],["meta",{"property":"og:description","content":"symfony7ä¹‹getSingleScalarResultæ–¹æ³•"}]]},"headers":[{"level":3,"title":"âœ… å¸¸è§ç”¨æ³•åœºæ™¯","slug":"âœ…-å¸¸è§ç”¨æ³•åœºæ™¯","link":"#âœ…-å¸¸è§ç”¨æ³•åœºæ™¯","children":[]},{"level":3,"title":"âš ï¸ æ³¨æ„äº‹é¡¹","slug":"âš ï¸-æ³¨æ„äº‹é¡¹","link":"#âš ï¸-æ³¨æ„äº‹é¡¹","children":[]},{"level":3,"title":"ğŸš« ä¸é€‚ç”¨çš„æƒ…å†µï¼š","slug":"ğŸš«-ä¸é€‚ç”¨çš„æƒ…å†µ","link":"#ğŸš«-ä¸é€‚ç”¨çš„æƒ…å†µ","children":[]}],"git":{},"filePathRelative":"content/php/symfony/symfony7ä¹‹getSingleScalarResultæ–¹æ³•.md"}');export{c as comp,r as data};
