import{_ as S,e as o,o as f,c as p,b as a,f as U,t as C,i as g,h as W,v as V,a as N}from"./app-CHrRue27.js";import{P as h,r as w,d as v,S as b}from"./PDFButton-UuvPomEf.js";import{f as j,p as k}from"./style-DT0i65DU.js";import"./commonjsHelpers-BosuxZz1.js";const z={__name:"PdfWatermark",setup(x,{expose:t}){t();const s=k(),e=o(null),n=o(""),l=o("water"),_={toast:s,file:e,previewUrl:n,watermarkText:l,handleFileChange:i=>{const r=i.target.files;r&&r.length>0&&(e.value=r[0])},addWatermark:async()=>{if(!e.value){s.success("请先选择 PDF 文件！");return}const i=await e.value.arrayBuffer(),r=await h.load(i),F=await r.embedFont(b.Helvetica),y=r.getPages();for(const m of y){const{width:T,height:B}=m.getSize();for(let d=0;d<B;d+=200)for(let c=0;c<T;c+=300)m.drawText(l.value,{x:c,y:d,size:36,font:F,color:w(0,.5,0),rotate:v(45),opacity:.25})}const P=await r.save(),D=new Blob([P],{type:"application/pdf"});n.value=URL.createObjectURL(D)},ref:o,get PDFDocument(){return h},get rgb(){return w},get degrees(){return v},get StandardFonts(){return b},get Toast(){return j},get useToast(){return k}};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}},L={class:"watermark-tool"},O={class:"input-group"},R={class:"upload-btn"},E={key:0,class:"file-name"},H=["disabled"],I={key:0,class:"preview"},M=["src"],q=["href"];function A(x,t,s,e,n,l){return f(),p("div",L,[t[2]||(t[2]=a("h2",{class:"title"},"📄 PDF 水印工具",-1)),a("div",O,[a("label",R,[t[1]||(t[1]=U(" 上传 PDF ")),a("input",{type:"file",accept:"application/pdf",onChange:e.handleFileChange},null,32)]),e.file?(f(),p("span",E,C(e.file.name),1)):g("",!0),W(a("input",{"onUpdate:modelValue":t[0]||(t[0]=u=>e.watermarkText=u),placeholder:"输入水印文字",class:"text-input"},null,512),[[V,e.watermarkText]]),a("button",{class:"add-watermark",onClick:e.addWatermark,disabled:!e.file},"添加水印",8,H)]),e.previewUrl?(f(),p("div",I,[a("iframe",{src:e.previewUrl,width:"100%",height:"600px"},null,8,M),a("a",{href:e.previewUrl,download:"watermarked.pdf",class:"download-btn"},"下载 PDF",8,q)])):g("",!0),N(e.Toast)])}const Y=S(z,[["render",A],["__scopeId","data-v-549c8be3"],["__file","PdfWatermark.vue"]]);export{Y as default};
