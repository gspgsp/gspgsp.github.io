import{_ as j,o as A,c as V,b as p,j as Z,v as G,h as N,F as b,m as S,z as K,t as ee}from"./app-BB_BIQV8.js";function d(){}d.prototype={diff:function(e,r){var o,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=u.callback;typeof u=="function"&&(t=u,u={});var i=this;function s(v){return v=i.postProcess(v,u),t?(setTimeout(function(){t(v)},0),!0):v}e=this.castInput(e,u),r=this.castInput(r,u),e=this.removeEmpty(this.tokenize(e,u)),r=this.removeEmpty(this.tokenize(r,u));var l=r.length,a=e.length,f=1,c=l+a;u.maxEditLength!=null&&(c=Math.min(c,u.maxEditLength));var y=(o=u.timeout)!==null&&o!==void 0?o:1/0,g=Date.now()+y,m=[{oldPos:-1,lastComponent:void 0}],h=this.extractCommon(m[0],r,e,0,u);if(m[0].oldPos+1>=a&&h+1>=l)return s(H(i,m[0].lastComponent,r,e,i.useLongestToken));var x=-1/0,w=1/0;function O(){for(var v=Math.max(x,-f);v<=Math.min(w,f);v+=2){var C=void 0,T=m[v-1],D=m[v+1];T&&(m[v-1]=void 0);var q=!1;if(D){var P=D.oldPos-v;q=D&&0<=P&&P<l}var U=T&&T.oldPos+1<a;if(!q&&!U){m[v]=void 0;continue}if(!U||q&&T.oldPos<D.oldPos?C=i.addToPath(D,!0,!1,0,u):C=i.addToPath(T,!1,!0,1,u),h=i.extractCommon(C,r,e,v,u),C.oldPos+1>=a&&h+1>=l)return s(H(i,C.lastComponent,r,e,i.useLongestToken));m[v]=C,C.oldPos+1>=a&&(w=Math.min(w,v-1)),h+1>=l&&(x=Math.max(x,v+1))}f++}if(t)(function v(){setTimeout(function(){if(f>c||Date.now()>g)return t();O()||v()},0)})();else for(;f<=c&&Date.now()<=g;){var I=O();if(I)return I}},addToPath:function(e,r,o,u,t){var i=e.lastComponent;return i&&!t.oneChangePerToken&&i.added===r&&i.removed===o?{oldPos:e.oldPos+u,lastComponent:{count:i.count+1,added:r,removed:o,previousComponent:i.previousComponent}}:{oldPos:e.oldPos+u,lastComponent:{count:1,added:r,removed:o,previousComponent:i}}},extractCommon:function(e,r,o,u,t){for(var i=r.length,s=o.length,l=e.oldPos,a=l-u,f=0;a+1<i&&l+1<s&&this.equals(o[l+1],r[a+1],t);)a++,l++,f++,t.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return f&&!t.oneChangePerToken&&(e.lastComponent={count:f,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=l,a},equals:function(e,r,o){return o.comparator?o.comparator(e,r):e===r||o.ignoreCase&&e.toLowerCase()===r.toLowerCase()},removeEmpty:function(e){for(var r=[],o=0;o<e.length;o++)e[o]&&r.push(e[o]);return r},castInput:function(e){return e},tokenize:function(e){return Array.from(e)},join:function(e){return e.join("")},postProcess:function(e){return e}};function H(n,e,r,o,u){for(var t=[],i;e;)t.push(e),i=e.previousComponent,delete e.previousComponent,e=i;t.reverse();for(var s=0,l=t.length,a=0,f=0;s<l;s++){var c=t[s];if(c.removed)c.value=n.join(o.slice(f,f+c.count)),f+=c.count;else{if(!c.added&&u){var y=r.slice(a,a+c.count);y=y.map(function(g,m){var h=o[f+m];return h.length>g.length?h:g}),c.value=n.join(y)}else c.value=n.join(r.slice(a,a+c.count));a+=c.count,c.added||(f+=c.count)}}return t}function Q(n,e){var r;for(r=0;r<n.length&&r<e.length;r++)if(n[r]!=e[r])return n.slice(0,r);return n.slice(0,r)}function X(n,e){var r;if(!n||!e||n[n.length-1]!=e[e.length-1])return"";for(r=0;r<n.length&&r<e.length;r++)if(n[n.length-(r+1)]!=e[e.length-(r+1)])return n.slice(-r);return n.slice(-r)}function J(n,e,r){if(n.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(n)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return r+n.slice(e.length)}function M(n,e,r){if(!e)return n+r;if(n.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(n)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return n.slice(0,-e.length)+r}function E(n,e){return J(n,e,"")}function $(n,e){return M(n,e,"")}function Y(n,e){return e.slice(0,ne(n,e))}function ne(n,e){var r=0;n.length>e.length&&(r=n.length-e.length);var o=e.length;n.length<e.length&&(o=n.length);var u=Array(o),t=0;u[0]=0;for(var i=1;i<o;i++){for(e[i]==e[t]?u[i]=u[t]:u[i]=t;t>0&&e[i]!=e[t];)t=u[t];e[i]==e[t]&&t++}t=0;for(var s=r;s<n.length;s++){for(;t>0&&n[s]!=e[t];)t=u[t];n[s]==e[t]&&t++}return t}var k="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",re=new RegExp("[".concat(k,"]+|\\s+|[^").concat(k,"]"),"ug"),z=new d;z.equals=function(n,e,r){return r.ignoreCase&&(n=n.toLowerCase(),e=e.toLowerCase()),n.trim()===e.trim()};z.tokenize=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r;if(e.intlSegmenter){if(e.intlSegmenter.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');r=Array.from(e.intlSegmenter.segment(n),function(t){return t.segment})}else r=n.match(re)||[];var o=[],u=null;return r.forEach(function(t){/\s/.test(t)?u==null?o.push(t):o.push(o.pop()+t):/\s/.test(u)?o[o.length-1]==u?o.push(o.pop()+t):o.push(u+t):o.push(t),u=t}),o};z.join=function(n){return n.map(function(e,r){return r==0?e:e.replace(/^\s+/,"")}).join("")};z.postProcess=function(n,e){if(!n||e.oneChangePerToken)return n;var r=null,o=null,u=null;return n.forEach(function(t){t.added?o=t:t.removed?u=t:((o||u)&&W(r,u,o,t),r=t,o=null,u=null)}),(o||u)&&W(r,u,o,null),n};function te(n,e,r){return z.diff(n,e,r)}function W(n,e,r,o){if(e&&r){var u=e.value.match(/^\s*/)[0],t=e.value.match(/\s*$/)[0],i=r.value.match(/^\s*/)[0],s=r.value.match(/\s*$/)[0];if(n){var l=Q(u,i);n.value=M(n.value,i,l),e.value=E(e.value,l),r.value=E(r.value,l)}if(o){var a=X(t,s);o.value=J(o.value,s,a),e.value=$(e.value,a),r.value=$(r.value,a)}}else if(r)n&&(r.value=r.value.replace(/^\s*/,"")),o&&(o.value=o.value.replace(/^\s*/,""));else if(n&&o){var f=o.value.match(/^\s*/)[0],c=e.value.match(/^\s*/)[0],y=e.value.match(/\s*$/)[0],g=Q(f,c);e.value=E(e.value,g);var m=X(E(f,g),y);e.value=$(e.value,m),o.value=J(o.value,f,m),n.value=M(n.value,f,f.slice(0,f.length-m.length))}else if(o){var h=o.value.match(/^\s*/)[0],x=e.value.match(/\s*$/)[0],w=Y(x,h);e.value=$(e.value,w)}else if(n){var O=n.value.match(/\s*$/)[0],I=e.value.match(/^\s*/)[0],v=Y(O,I);e.value=E(e.value,v)}}var oe=new d;oe.tokenize=function(n){var e=new RegExp("(\\r?\\n)|[".concat(k,"]+|[^\\S\\n\\r]+|[^").concat(k,"]"),"ug");return n.match(e)||[]};var _=new d;_.tokenize=function(n,e){e.stripTrailingCr&&(n=n.replace(/\r\n/g,`
`));var r=[],o=n.split(/(\n|\r\n)/);o[o.length-1]||o.pop();for(var u=0;u<o.length;u++){var t=o[u];u%2&&!e.newlineIsToken?r[r.length-1]+=t:r.push(t)}return r};_.equals=function(n,e,r){return r.ignoreWhitespace?((!r.newlineIsToken||!n.includes(`
`))&&(n=n.trim()),(!r.newlineIsToken||!e.includes(`
`))&&(e=e.trim())):r.ignoreNewlineAtEof&&!r.newlineIsToken&&(n.endsWith(`
`)&&(n=n.slice(0,-1)),e.endsWith(`
`)&&(e=e.slice(0,-1))),d.prototype.equals.call(this,n,e,r)};var ue=new d;ue.tokenize=function(n){return n.split(/(\S.+?[.!?])(?=\s+|$)/)};var ie=new d;ie.tokenize=function(n){return n.split(/([{}:;,]|\s+)/)};function R(n){"@babel/helpers - typeof";return R=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(n)}var L=new d;L.useLongestToken=!0;L.tokenize=_.tokenize;L.castInput=function(n,e){var r=e.undefinedReplacement,o=e.stringifyReplacer,u=o===void 0?function(t,i){return typeof i>"u"?r:i}:o;return typeof n=="string"?n:JSON.stringify(F(n,null,null,u),u,"  ")};L.equals=function(n,e,r){return d.prototype.equals.call(L,n.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"),r)};function F(n,e,r,o,u){e=e||[],r=r||[],o&&(n=o(u,n));var t;for(t=0;t<e.length;t+=1)if(e[t]===n)return r[t];var i;if(Object.prototype.toString.call(n)==="[object Array]"){for(e.push(n),i=new Array(n.length),r.push(i),t=0;t<n.length;t+=1)i[t]=F(n[t],e,r,o,u);return e.pop(),r.pop(),i}if(n&&n.toJSON&&(n=n.toJSON()),R(n)==="object"&&n!==null){e.push(n),i={},r.push(i);var s=[],l;for(l in n)Object.prototype.hasOwnProperty.call(n,l)&&s.push(l);for(s.sort(),t=0;t<s.length;t+=1)l=s[t],i[l]=F(n[l],e,r,o,l);e.pop(),r.pop()}else i=n;return i}var B=new d;B.tokenize=function(n){return n.slice()};B.join=B.removeEmpty=function(n){return n};const le={data(){return{oldText:"",newText:""}},computed:{diffParts(){return te(this.oldText,this.newText)}}},se={class:"content-wrapper"},fe={class:"content-box"},ae={class:"text-box"},ve={class:"text-box"},ce={class:"diff-box"};function me(n,e,r,o,u,t){return A(),V("div",se,[p("div",fe,[p("div",ae,[e[2]||(e[2]=p("p",null,"旧文本(Old text)",-1)),Z(p("textarea",{"onUpdate:modelValue":e[0]||(e[0]=i=>u.oldText=i),rows:"50",cols:"30",placeholder:"在此输入旧文本"},null,512),[[G,u.oldText]])]),p("div",ve,[e[3]||(e[3]=p("p",null,"新文本(New text)",-1)),Z(p("textarea",{"onUpdate:modelValue":e[1]||(e[1]=i=>u.newText=i),rows:"50",cols:"30",placeholder:"在此输入新文本"},null,512),[[G,u.newText]])])]),p("div",ce,[e[8]||(e[8]=p("p",null,"文本差异(Difference: added with green color, removed with red color):",-1)),p("pre",null,[e[6]||(e[6]=N("                ")),p("code",null,[e[4]||(e[4]=N(`
                  `)),(A(!0),V(b,null,S(t.diffParts,(i,s)=>(A(),V("span",{key:s,style:K({color:i.added?"green":i.removed?"red":"black"})},`
                    `+ee(i.value)+`
                  `,5))),128)),e[5]||(e[5]=N(`
                `))]),e[7]||(e[7]=N(`
            `))])])])}const de=j(le,[["render",me],["__scopeId","data-v-0132c34e"],["__file","DiffViewer.vue"]]);export{de as default};
