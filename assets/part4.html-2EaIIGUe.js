import{_ as s,c as a,f as e,o as l}from"./app-BB_BIQV8.js";const p={};function t(i,n){return l(),a("div",null,n[0]||(n[0]=[e(`<h2 id="基于minikube的滚动更新" tabindex="-1"><a class="header-anchor" href="#基于minikube的滚动更新"><span>基于minikube的滚动更新</span></a></h2><h3 id="在宿主机构建镜像-之前的" tabindex="-1"><a class="header-anchor" href="#在宿主机构建镜像-之前的"><span>在宿主机构建镜像(之前的)</span></a></h3><blockquote><p>cd go-gateway-demo<br> docker build -t go-gateway-demo:0.1 .</p></blockquote><h3 id="加载到-minikube" tabindex="-1"><a class="header-anchor" href="#加载到-minikube"><span>加载到 minikube</span></a></h3><blockquote><p>minikube image load go-gateway-demo:0.1</p></blockquote><hr><h3 id="修改项目逻辑" tabindex="-1"><a class="header-anchor" href="#修改项目逻辑"><span>修改项目逻辑</span></a></h3><blockquote><p>cd go-gateway-demo<br> docker build -t go-gateway-demo:0.2 .</p></blockquote><h3 id="加载到-minikube-1" tabindex="-1"><a class="header-anchor" href="#加载到-minikube-1"><span>加载到 minikube</span></a></h3><blockquote><p>minikube image load go-gateway-demo:0.2</p></blockquote><hr><h2 id="验证镜像已在-minikube-可用" tabindex="-1"><a class="header-anchor" href="#验证镜像已在-minikube-可用"><span>验证镜像已在 minikube 可用</span></a></h2><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">$ minikube image ls | grep go-gateway-demo</span>
<span class="line">docker.io/library/go-gateway-demo:0.2</span>
<span class="line">docker.io/library/go-gateway-demo:0.1</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="修改deployment-yaml文件" tabindex="-1"><a class="header-anchor" href="#修改deployment-yaml文件"><span>修改deployment.yaml文件</span></a></h2><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1</span>
<span class="line"><span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment</span>
<span class="line"><span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">name</span><span class="token punctuation">:</span> go<span class="token punctuation">-</span>demo</span>
<span class="line"><span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">4</span></span>
<span class="line">  <span class="token key atrule">strategy</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">type</span><span class="token punctuation">:</span> RollingUpdate</span>
<span class="line">    <span class="token key atrule">rollingUpdate</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">maxSurge</span><span class="token punctuation">:</span> <span class="token number">1</span></span>
<span class="line">      <span class="token key atrule">maxUnavailable</span><span class="token punctuation">:</span> <span class="token number">1</span></span>
<span class="line">  <span class="token key atrule">selector</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">app</span><span class="token punctuation">:</span> go<span class="token punctuation">-</span>demo</span>
<span class="line">  <span class="token key atrule">template</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">metadata</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">labels</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token key atrule">app</span><span class="token punctuation">:</span> go<span class="token punctuation">-</span>demo</span>
<span class="line">    <span class="token key atrule">spec</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">containers</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> app</span>
<span class="line">          <span class="token key atrule">image</span><span class="token punctuation">:</span> go<span class="token punctuation">-</span>gateway<span class="token punctuation">-</span>demo<span class="token punctuation">:</span><span class="token number">0.1</span></span>
<span class="line">          <span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> IfNotPresent</span>
<span class="line">          <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">8080</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="主要改动-添加如下配置" tabindex="-1"><a class="header-anchor" href="#主要改动-添加如下配置"><span>主要改动，添加如下配置</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line">  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">4</span></span>
<span class="line">  <span class="token key atrule">strategy</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">type</span><span class="token punctuation">:</span> RollingUpdate</span>
<span class="line">    <span class="token key atrule">rollingUpdate</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">maxSurge</span><span class="token punctuation">:</span> <span class="token number">1</span></span>
<span class="line">      <span class="token key atrule">maxUnavailable</span><span class="token punctuation">:</span> <span class="token number">1</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="执行如下命令" tabindex="-1"><a class="header-anchor" href="#执行如下命令"><span>执行如下命令</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">$ kubectl apply <span class="token parameter variable">-f</span> deploy/deployment.yaml</span>
<span class="line">deployment.apps/go-demo configured</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="重新加载配置" tabindex="-1"><a class="header-anchor" href="#重新加载配置"><span>重新加载配置</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">$ kubectl <span class="token builtin class-name">set</span> image deployment/go-demo <span class="token assign-left variable">app</span><span class="token operator">=</span>go-gateway-demo:0.2</span>
<span class="line">deployment.apps/go-demo image updated</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="查看滚动更新状态" tabindex="-1"><a class="header-anchor" href="#查看滚动更新状态"><span>查看滚动更新状态</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">$ kubectl rollout status deployment/go-demo</span>
<span class="line">deployment <span class="token string">&quot;go-demo&quot;</span> successfully rolled out</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="查看pod运行状态-4个pod都正常运行" tabindex="-1"><a class="header-anchor" href="#查看pod运行状态-4个pod都正常运行"><span>查看POD运行状态(4个pod都正常运行)</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">$ kubectl get pods <span class="token parameter variable">-l</span> <span class="token assign-left variable">app</span><span class="token operator">=</span>go-demo</span>
<span class="line">NAME                       READY   STATUS    RESTARTS   AGE</span>
<span class="line">go-demo-84949577fc-48cc5   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          37s</span>
<span class="line">go-demo-84949577fc-d4n4m   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          37s</span>
<span class="line">go-demo-84949577fc-wcmb8   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          39s</span>
<span class="line">go-demo-84949577fc-zw6zc   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          39s</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="测试运行-修改前的状态" tabindex="-1"><a class="header-anchor" href="#测试运行-修改前的状态"><span>测试运行(修改前的状态)</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">$ <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">..</span><span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">do</span> <span class="token function">curl</span> http://demo.local/<span class="token punctuation">;</span> <span class="token builtin class-name">echo</span><span class="token punctuation">;</span> <span class="token keyword">done</span></span>
<span class="line">hello from go on k8s + gateway api go-demo-67bd54f954-s2w76</span>
<span class="line">hello from go on k8s + gateway api go-demo-67bd54f954-s2w76</span>
<span class="line">hello from go on k8s + gateway api go-demo-67bd54f954-s2w76</span>
<span class="line">hello from go on k8s + gateway api go-demo-67bd54f954-s2w76</span>
<span class="line">hello from go on k8s + gateway api go-demo-67bd54f954-s2w76</span>
<span class="line">hello from go on k8s + gateway api go-demo-67bd54f954-s2w76</span>
<span class="line">hello from go on k8s + gateway api go-demo-67bd54f954-s2w76</span>
<span class="line">hello from go on k8s + gateway api go-demo-67bd54f954-s2w76</span>
<span class="line">hello from go on k8s + gateway api go-demo-67bd54f954-s2w76</span>
<span class="line">hello from go on k8s + gateway api go-demo-67bd54f954-s2w76</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="测试运行-修改后的状态" tabindex="-1"><a class="header-anchor" href="#测试运行-修改后的状态"><span>测试运行(修改后的状态)</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">$ <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">..</span><span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">do</span> <span class="token function">curl</span> http://demo.local/<span class="token punctuation">;</span> <span class="token builtin class-name">echo</span><span class="token punctuation">;</span> <span class="token keyword">done</span></span>
<span class="line">hello from go on k8s + gateway api go-demo-67bd54f954-qrrjk</span>
<span class="line">hello from go on k8s + gateway api go-demo-67bd54f954-fwwz7</span>
<span class="line">hello from go on k8s + gateway api go-demo-67bd54f954-d75qr</span>
<span class="line">hello from go on k8s + gateway api go-demo-67bd54f954-d75qr</span>
<span class="line">hello from go on k8s + gateway api go-demo-67bd54f954-fwwz7</span>
<span class="line">hello from go on k8s + gateway api go-demo-67bd54f954-pqpzv</span>
<span class="line">hello from go on k8s + gateway api go-demo-67bd54f954-d75qr</span>
<span class="line">hello from go on k8s + gateway api go-demo-67bd54f954-pqpzv</span>
<span class="line">hello from go on k8s + gateway api go-demo-67bd54f954-d75qr</span>
<span class="line">hello from go on k8s + gateway api go-demo-67bd54f954-fwwz7</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="补充命令" tabindex="-1"><a class="header-anchor" href="#补充命令"><span>补充命令</span></a></h2><h3 id="查看deployment文件前后加载的差异-仅参考-其中的步骤有些复杂" tabindex="-1"><a class="header-anchor" href="#查看deployment文件前后加载的差异-仅参考-其中的步骤有些复杂"><span>查看deployment文件前后加载的差异(仅参考，其中的步骤有些复杂)</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">$ kubectl <span class="token function">diff</span> <span class="token parameter variable">-f</span> deploy/deployment.yaml</span>
<span class="line"><span class="token function">diff</span> <span class="token parameter variable">-u</span> <span class="token parameter variable">-N</span> /tmp/LIVE-3866417283/apps.v1.Deployment.default.go-demo /tmp/MERGED-901841631/apps.v1.Deployment.default.go-demo</span>
<span class="line">--- /tmp/LIVE-3866417283/apps.v1.Deployment.default.go-demo     <span class="token number">2026</span>-01-29 <span class="token number">14</span>:17:15.611423444 +0800</span>
<span class="line">+++ /tmp/MERGED-901841631/apps.v1.Deployment.default.go-demo    <span class="token number">2026</span>-01-29 <span class="token number">14</span>:17:15.612423396 +0800</span>
<span class="line">@@ -6,7 +6,7 @@</span>
<span class="line">     kubectl.kubernetes.io/last-applied-configuration: <span class="token operator">|</span></span>
<span class="line">       <span class="token punctuation">{</span><span class="token string">&quot;apiVersion&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;apps/v1&quot;</span>,<span class="token string">&quot;kind&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;Deployment&quot;</span>,<span class="token string">&quot;metadata&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;annotations&quot;</span>:<span class="token punctuation">{</span><span class="token punctuation">}</span>,<span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;go-demo&quot;</span>,<span class="token string">&quot;namespace&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;default&quot;</span><span class="token punctuation">}</span>,<span class="token string">&quot;spec&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;replicas&quot;</span>:4,<span class="token string">&quot;selector&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;matchLabels&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;app&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;go-demo&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>,<span class="token string">&quot;strategy&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;rollingUpdate&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;maxSurge&quot;</span>:1,<span class="token string">&quot;maxUnavailable&quot;</span>:1<span class="token punctuation">}</span>,<span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;RollingUpdate&quot;</span><span class="token punctuation">}</span>,<span class="token string">&quot;template&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;metadata&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;labels&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;app&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;go-demo&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>,<span class="token string">&quot;spec&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;containers&quot;</span>:<span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;image&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;go-gateway-demo:0.1&quot;</span>,<span class="token string">&quot;imagePullPolicy&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;IfNotPresent&quot;</span>,<span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;app&quot;</span>,<span class="token string">&quot;ports&quot;</span>:<span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;containerPort&quot;</span>:8080<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">   creationTimestamp: <span class="token string">&quot;2026-01-12T03:28:19Z&quot;</span></span>
<span class="line">-  generation: <span class="token number">4</span></span>
<span class="line">+  generation: <span class="token number">5</span></span>
<span class="line">   name: go-demo</span>
<span class="line">   namespace: default</span>
<span class="line">   resourceVersion: <span class="token string">&quot;124260&quot;</span></span>
<span class="line">@@ -30,7 +30,7 @@</span>
<span class="line">         app: go-demo</span>
<span class="line">     spec:</span>
<span class="line">       containers:</span>
<span class="line">-      - image: go-gateway-demo:0.2</span>
<span class="line">+      - image: go-gateway-demo:0.1</span>
<span class="line">         imagePullPolicy: IfNotPresent</span>
<span class="line">         name: app</span>
<span class="line">         ports:</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,32)]))}const c=s(p,[["render",t],["__file","part4.html.vue"]]),u=JSON.parse('{"path":"/project/k8s/part4.html","title":"","lang":"en-US","frontmatter":{"sidebarDepth":0},"headers":[{"level":2,"title":"基于minikube的滚动更新","slug":"基于minikube的滚动更新","link":"#基于minikube的滚动更新","children":[{"level":3,"title":"在宿主机构建镜像(之前的)","slug":"在宿主机构建镜像-之前的","link":"#在宿主机构建镜像-之前的","children":[]},{"level":3,"title":"加载到 minikube","slug":"加载到-minikube","link":"#加载到-minikube","children":[]},{"level":3,"title":"修改项目逻辑","slug":"修改项目逻辑","link":"#修改项目逻辑","children":[]},{"level":3,"title":"加载到 minikube","slug":"加载到-minikube-1","link":"#加载到-minikube-1","children":[]}]},{"level":2,"title":"验证镜像已在 minikube 可用","slug":"验证镜像已在-minikube-可用","link":"#验证镜像已在-minikube-可用","children":[]},{"level":2,"title":"修改deployment.yaml文件","slug":"修改deployment-yaml文件","link":"#修改deployment-yaml文件","children":[{"level":3,"title":"主要改动，添加如下配置","slug":"主要改动-添加如下配置","link":"#主要改动-添加如下配置","children":[]}]},{"level":2,"title":"执行如下命令","slug":"执行如下命令","link":"#执行如下命令","children":[]},{"level":2,"title":"重新加载配置","slug":"重新加载配置","link":"#重新加载配置","children":[]},{"level":2,"title":"查看滚动更新状态","slug":"查看滚动更新状态","link":"#查看滚动更新状态","children":[]},{"level":2,"title":"查看POD运行状态(4个pod都正常运行)","slug":"查看pod运行状态-4个pod都正常运行","link":"#查看pod运行状态-4个pod都正常运行","children":[]},{"level":2,"title":"测试运行(修改前的状态)","slug":"测试运行-修改前的状态","link":"#测试运行-修改前的状态","children":[]},{"level":2,"title":"测试运行(修改后的状态)","slug":"测试运行-修改后的状态","link":"#测试运行-修改后的状态","children":[]},{"level":2,"title":"补充命令","slug":"补充命令","link":"#补充命令","children":[{"level":3,"title":"查看deployment文件前后加载的差异(仅参考，其中的步骤有些复杂)","slug":"查看deployment文件前后加载的差异-仅参考-其中的步骤有些复杂","link":"#查看deployment文件前后加载的差异-仅参考-其中的步骤有些复杂","children":[]}]}],"git":{},"filePathRelative":"project/k8s/part4.md"}');export{c as comp,u as data};
