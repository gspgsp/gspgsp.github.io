import{_ as p,c as i,d as l,a as s,o as c,r as a}from"./app-CHrRue27.js";const o={};function u(r,n){const t=a("BackBtn"),e=a("CommentService");return c(),i("div",null,[n[0]||(n[0]=l(`<p>gin框架下将微信预支付链接转base64图片流：</p><p>1.安装需要的拓展包 go get github.com/skip2/go-qrcode</p><p>2.具体实现代码</p><div class="language-go line-numbers-mode" data-highlighter="prismjs" data-ext="go" data-title="go"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function">ReturnValue</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    qrCode<span class="token punctuation">,</span> err <span class="token operator">:=</span> qrcode<span class="token punctuation">.</span><span class="token function">Encode</span><span class="token punctuation">(</span><span class="token string">&quot;weixin://wxpay/bizpayurl?pr=6094umbzz&quot;</span><span class="token punctuation">,</span> qrcode<span class="token punctuation">.</span>Medium<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span></span>
<span class="line">        c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>StatusInternalServerError<span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">{</span><span class="token string">&quot;resp&quot;</span><span class="token punctuation">:</span> err<span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    base64Data <span class="token operator">:=</span> base64<span class="token punctuation">.</span>StdEncoding<span class="token punctuation">.</span><span class="token function">EncodeToString</span><span class="token punctuation">(</span>qrCode<span class="token punctuation">)</span></span>
<span class="line">    c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>StatusOK<span class="token punctuation">,</span>gin<span class="token punctuation">.</span>H<span class="token punctuation">{</span></span>
<span class="line">        <span class="token string">&quot;code&quot;</span><span class="token punctuation">:</span>http<span class="token punctuation">.</span>StatusOK<span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&quot;message&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;成功&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&quot;data&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;data:image/png;base64,&quot;</span><span class="token operator">+</span>base64Data<span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">小技巧：</span>
<span class="line">1.如果不想返回json数据可以直接调用 c.Data 返回指定格式的数据</span>
<span class="line"> c.JSON(http.StatusOK,gin.H{</span>
<span class="line">        &quot;code&quot;:http.StatusOK,</span>
<span class="line">        &quot;message&quot;:&quot;成功&quot;,</span>
<span class="line">        &quot;data&quot;:&quot;data:image/png;base64,&quot;+base64Data,</span>
<span class="line">    })</span>
<span class="line"></span>
<span class="line">c.Data(200,&quot;Content-Type/image/png&quot;,qrCode)// qrCode为[]byte 类型, 直接输出图片到客户端</span>
<span class="line"></span>
<span class="line">2.通过 fmt.Fprint 返回指定格式的数据，这个在支付宝支付的时候会用到</span>
<span class="line"></span>
<span class="line">const (</span>
<span class="line">    AckSuccess = \`&lt;xml&gt;&lt;return_code&gt;&lt;![CDATA[SUCCESS]]&gt;&lt;/return_code&gt;&lt;/xml&gt;\`</span>
<span class="line">    AckFail    = \`&lt;xml&gt;&lt;return_code&gt;&lt;![CDATA[FAIL]]&gt;&lt;/return_code&gt;&lt;/xml&gt;\`</span>
<span class="line">)</span>
<span class="line"></span>
<span class="line">fmt.Fprint(c.Writer, AckSuccess)//直接调用这个就会返回数据给客户端，因为writer会写数据</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5)),s(t),s(e)])}const v=p(o,[["render",u],["__file","gin框架下将微信预支付链接转base64图片流.html.vue"]]),k=JSON.parse('{"path":"/content/go/gin/gin%E6%A1%86%E6%9E%B6%E4%B8%8B%E5%B0%86%E5%BE%AE%E4%BF%A1%E9%A2%84%E6%94%AF%E4%BB%98%E9%93%BE%E6%8E%A5%E8%BD%ACbase64%E5%9B%BE%E7%89%87%E6%B5%81.html","title":"gin框架下将微信预支付链接转base64图片流","lang":"en-US","frontmatter":{"sidebar":false,"title":"gin框架下将微信预支付链接转base64图片流","description":"gin框架下将微信预支付链接转base64图片流"},"headers":[],"git":{},"filePathRelative":"content/go/gin/gin框架下将微信预支付链接转base64图片流.md"}');export{v as comp,k as data};
