import{_ as n,c as e,f as a,o as i}from"./app-BB_BIQV8.js";const l={};function c(d,s){return i(),e("div",null,s[0]||(s[0]=[a(`<div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">搭建服务以后，会对其做压力测试，这里选择ab压力测试</span>
<span class="line"></span>
<span class="line">ab的概念:</span>
<span class="line">ab是ApacheBench命令的缩写。</span>
<span class="line"></span>
<span class="line">ab的原理:</span>
<span class="line">ab命令会创建多个并发访问线程，模拟多个访问者同时对某一URL地址进行访问。它的测试目标是基于URL的，因此，它既可以用来测试apache的负载压力，也可以测试nginx等其它Web服务器的压力。</span>
<span class="line"></span>
<span class="line">ab的安装:</span>
<span class="line">[root@k8smaster k8s-cluster]# yum install httpd-tools</span>
<span class="line"></span>
<span class="line">ab参数说明:</span>
<span class="line">[root@k8smaster ~]# ab --help</span>
<span class="line">ab: wrong number of arguments</span>
<span class="line">Usage: ab [options] [http[s]://]hostname[:port]/path</span>
<span class="line">Options are:</span>
<span class="line">    -n requests     Number of requests to perform</span>
<span class="line">    -c concurrency  Number of multiple requests to make at a time</span>
<span class="line">    -t timelimit    Seconds to max. to spend on benchmarking</span>
<span class="line">                    This implies -n 50000</span>
<span class="line">    -s timeout      Seconds to max. wait for each response</span>
<span class="line">                    Default is 30 seconds</span>
<span class="line">    -b windowsize   Size of TCP send/receive buffer, in bytes</span>
<span class="line">    -B address      Address to bind to when making outgoing connections</span>
<span class="line">    -p postfile     File containing data to POST. Remember also to set -T</span>
<span class="line">    -u putfile      File containing data to PUT. Remember also to set -T</span>
<span class="line">    -T content-type Content-type header to use for POST/PUT data, eg.</span>
<span class="line">                    &#39;application/x-www-form-urlencoded&#39;</span>
<span class="line">                    Default is &#39;text/plain&#39;</span>
<span class="line">    -v verbosity    How much troubleshooting info to print</span>
<span class="line">    -w              Print out results in HTML tables</span>
<span class="line">    -i              Use HEAD instead of GET</span>
<span class="line">    -x attributes   String to insert as table attributes</span>
<span class="line">    -y attributes   String to insert as tr attributes</span>
<span class="line">    -z attributes   String to insert as td or th attributes</span>
<span class="line">    -C attribute    Add cookie, eg. &#39;Apache=1234&#39;. (repeatable)</span>
<span class="line">    -H attribute    Add Arbitrary header line, eg. &#39;Accept-Encoding: gzip&#39;</span>
<span class="line">                    Inserted after all normal header lines. (repeatable)</span>
<span class="line">    -A attribute    Add Basic WWW Authentication, the attributes</span>
<span class="line">                    are a colon separated username and password.</span>
<span class="line">    -P attribute    Add Basic Proxy Authentication, the attributes</span>
<span class="line">                    are a colon separated username and password.</span>
<span class="line">    -X proxy:port   Proxyserver and port number to use</span>
<span class="line">    -V              Print version number and exit</span>
<span class="line">    -k              Use HTTP KeepAlive feature</span>
<span class="line">    -d              Do not show percentiles served table.</span>
<span class="line">    -S              Do not show confidence estimators and warnings.</span>
<span class="line">    -q              Do not show progress when doing more than 150 requests</span>
<span class="line">    -g filename     Output collected data to gnuplot format file.</span>
<span class="line">    -e filename     Output CSV file with percentages served</span>
<span class="line">    -r              Don&#39;t exit on socket receive errors.</span>
<span class="line">    -h              Display usage information (this message)</span>
<span class="line">    -Z ciphersuite  Specify SSL/TLS cipher suite (See openssl ciphers)</span>
<span class="line">    -f protocol     Specify SSL/TLS protocol</span>
<span class="line">                    (SSL3, TLS1, TLS1.1, TLS1.2 or ALL)</span>
<span class="line"></span>
<span class="line"></span>
<span class="line">-n：在测试会话中所执行的请求个数。默认时，仅执行一个请求。</span>
<span class="line"></span>
<span class="line">-c：一次产生的请求个数。默认是一次一个。</span>
<span class="line"></span>
<span class="line">ab -c 100 -n 200 http://192.168.123.142/</span>
<span class="line">上面的语句表示有100个并发访问，每秒总共有200个请求，在此情况下进行压力测试。</span>
<span class="line"></span>
<span class="line"></span>
<span class="line">ab性能指标:</span>
<span class="line">1、吞吐率（Requests per second）</span>
<span class="line">服务器并发处理能力的量化描述，单位是reqs/s，指的是在某个并发用户数下单位时间内处理的请求数。某个并发用户数下单位时间内能处理的最大请求数，称之为最大吞吐率。</span>
<span class="line"></span>
<span class="line">记住：吞吐率是基于并发用户数的。这句话代表了两个含义：</span>
<span class="line">a、吞吐率和并发用户数相关</span>
<span class="line">b、不同的并发用户数下，吞吐率一般是不同的</span>
<span class="line"></span>
<span class="line">计算公式：总请求数/处理完成这些请求数所花费的时间，即</span>
<span class="line">Request per second=Complete requests/Time taken for tests</span>
<span class="line"></span>
<span class="line">必须要说明的是，这个数值表示当前机器的整体性能，值越大越好。</span>
<span class="line"></span>
<span class="line">2、并发连接数（The number of concurrent connections）</span>
<span class="line">并发连接数指的是某个时刻服务器所接受的请求数目，简单的讲，就是一个会话。</span>
<span class="line"></span>
<span class="line">3、并发用户数（Concurrency Level）</span>
<span class="line">要注意区分这个概念和并发连接数之间的区别，一个用户可能同时会产生多个会话，也即连接数。在HTTP/1.1下，IE7支持两个并发连接，IE8支持6个并发连接，FireFox3支持4个并发连接，所以相应的，我们的并发用户数就得除以这个基数。</span>
<span class="line"></span>
<span class="line">4、用户平均请求等待时间（Time per request）</span>
<span class="line"></span>
<span class="line">计算公式：处理完成所有请求数所花费的时间/（总请求数/并发用户数），即：</span>
<span class="line">Time per request=Time taken for tests/（Complete requests/Concurrency Level）</span>
<span class="line"></span>
<span class="line">5、服务器平均请求等待时间（Time per request:across all concurrent requests）</span>
<span class="line"></span>
<span class="line">计算公式：处理完成所有请求数所花费的时间/总请求数，即：</span>
<span class="line">Time taken for/testsComplete requests</span>
<span class="line">可以看到，它是吞吐率的倒数。</span>
<span class="line"></span>
<span class="line">同时，它也等于用户平均请求等待时间/并发用户数，即</span>
<span class="line">Time per request/Concurrency Level</span>
<span class="line"></span>
<span class="line"></span>
<span class="line">ad压力测试案例:</span>
<span class="line">[root@k8smaster k8s-cluster]# ab -n 1000 -c 10 https://test.abc.com/v1/test/helloword</span>
<span class="line">This is ApacheBench, Version 2.3 &lt;$Revision: 1430300 $&gt;</span>
<span class="line">Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/</span>
<span class="line">Licensed to The Apache Software Foundation, http://www.apache.org/</span>
<span class="line"></span>
<span class="line">Benchmarking test.abc.com (be patient)</span>
<span class="line">Completed 100 requests</span>
<span class="line">Completed 200 requests</span>
<span class="line">Completed 300 requests</span>
<span class="line">Completed 400 requests</span>
<span class="line">Completed 500 requests</span>
<span class="line">Completed 600 requests</span>
<span class="line">Completed 700 requests</span>
<span class="line">Completed 800 requests</span>
<span class="line">Completed 900 requests</span>
<span class="line">Completed 1000 requests</span>
<span class="line">Finished 1000 requests</span>
<span class="line"></span>
<span class="line"></span>
<span class="line">Server Software:        </span>
<span class="line">Server Hostname:        test.abc.com</span>
<span class="line">Server Port:            443</span>
<span class="line">SSL/TLS Protocol:       TLSv1.2,ECDHE-RSA-AES128-GCM-SHA256,2048,128</span>
<span class="line"></span>
<span class="line">Document Path:          /v1/test/helloword</span>
<span class="line">Document Length:        21 bytes</span>
<span class="line"></span>
<span class="line">Concurrency Level:      10</span>
<span class="line">Time taken for tests:   13.639 seconds</span>
<span class="line">Complete requests:      1000</span>
<span class="line">Failed requests:        0</span>
<span class="line">Write errors:           0</span>
<span class="line">Total transferred:      221000 bytes</span>
<span class="line">HTML transferred:       21000 bytes</span>
<span class="line">Requests per second:    73.32 [#/sec] (mean)</span>
<span class="line">Time per request:       136.389 [ms] (mean)</span>
<span class="line">Time per request:       13.639 [ms] (mean, across all concurrent requests)</span>
<span class="line">Transfer rate:          15.82 [Kbytes/sec] received</span>
<span class="line"></span>
<span class="line">Connection Times (ms)</span>
<span class="line">              min  mean[+/-sd] median   max</span>
<span class="line">Connect:       12  117 286.8     22    1674</span>
<span class="line">Processing:     4   13  36.8      5     619</span>
<span class="line">Waiting:        4   13  36.8      5     619</span>
<span class="line">Total:         16  130 290.3     30    1680</span>
<span class="line"></span>
<span class="line">Percentage of the requests served within a certain time (ms)</span>
<span class="line">  50%     30</span>
<span class="line">  66%     61</span>
<span class="line">  75%     68</span>
<span class="line">  80%     73</span>
<span class="line">  90%    288</span>
<span class="line">  95%    840</span>
<span class="line">  98%   1655</span>
<span class="line">  99%   1661</span>
<span class="line"> 100%   1680 (longest request)</span>
<span class="line"> </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1)]))}const r=n(l,[["render",c],["__file","ab压力测试.html.vue"]]),t=JSON.parse('{"path":"/content/other/spread/ab%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95.html","title":"ab压力测试","lang":"en-US","frontmatter":{"sidebar":false,"title":"ab压力测试","description":"ab压力测试"},"headers":[],"git":{},"filePathRelative":"content/other/spread/ab压力测试.md"}');export{r as comp,t as data};
