import{_ as t,c as l,a as n,f as o,o as i,r as a}from"./app-BB_BIQV8.js";const c={};function r(u,s){const p=a("DocSearchInPage"),e=a("InArticleAd");return i(),l("div",null,[n(p),n(e),s[0]||(s[0]=o(`<h1 id="mongodb-使用手册" tabindex="-1"><a class="header-anchor" href="#mongodb-使用手册"><span>MongoDB 使用手册</span></a></h1><h2 id="简介" tabindex="-1"><a class="header-anchor" href="#简介"><span>简介</span></a></h2><p>MongoDB 是一个基于分布式文件存储的 NoSQL 数据库系统,由 C++ 编写。它支持丰富的查询语言,提供高性能、高可用性和易扩展性。</p><p><strong>主要特点:</strong></p><ul><li>面向文档存储,使用 BSON(Binary JSON)格式</li><li>支持动态模式,无需预定义表结构</li><li>强大的查询和聚合功能</li><li>自动分片和副本集支持</li><li>支持多文档 ACID 事务</li></ul><p><strong>适用场景:</strong></p><ul><li>内容管理系统</li><li>实时分析</li><li>物联网数据存储</li><li>移动应用后端</li><li>游戏数据存储</li></ul><hr><h2 id="安装与配置" tabindex="-1"><a class="header-anchor" href="#安装与配置"><span>安装与配置</span></a></h2><h3 id="安装-mongodb" tabindex="-1"><a class="header-anchor" href="#安装-mongodb"><span>安装 MongoDB</span></a></h3><p><strong>Linux (Ubuntu/Debian):</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 导入公钥</span></span>
<span class="line"><span class="token function">wget</span> <span class="token parameter variable">-qO</span> - https://www.mongodb.org/static/pgp/server-7.0.asc <span class="token operator">|</span> <span class="token function">sudo</span> apt-key <span class="token function">add</span> -</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 添加源</span></span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token string">&quot;deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu jammy/mongodb-org/7.0 multiverse&quot;</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> /etc/apt/sources.list.d/mongodb-org-7.0.list</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 安装</span></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">apt-get</span> update</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> mongodb-org</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 启动服务</span></span>
<span class="line"><span class="token function">sudo</span> systemctl start mongod</span>
<span class="line"><span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> mongod</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>macOS:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 使用 Homebrew</span></span>
<span class="line">brew tap mongodb/brew</span>
<span class="line">brew <span class="token function">install</span> mongodb-community@7.0</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 启动服务</span></span>
<span class="line">brew services start mongodb-community@7.0</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Windows:</strong> 下载 MSI 安装包从 MongoDB 官网,按照向导安装。</p><h3 id="配置文件" tabindex="-1"><a class="header-anchor" href="#配置文件"><span>配置文件</span></a></h3><p>MongoDB 配置文件通常位于 <code>/etc/mongod.conf</code> (Linux) 或 <code>C:\\Program Files\\MongoDB\\Server\\7.0\\bin\\mongod.cfg</code> (Windows)。</p><p><strong>基本配置示例:</strong></p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">storage</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">dbPath</span><span class="token punctuation">:</span> /var/lib/mongodb</span>
<span class="line">  <span class="token key atrule">journal</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></span>
<span class="line"></span>
<span class="line"><span class="token key atrule">systemLog</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">destination</span><span class="token punctuation">:</span> file</span>
<span class="line">  <span class="token key atrule">path</span><span class="token punctuation">:</span> /var/log/mongodb/mongod.log</span>
<span class="line">  <span class="token key atrule">logAppend</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></span>
<span class="line"></span>
<span class="line"><span class="token key atrule">net</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">27017</span></span>
<span class="line">  <span class="token key atrule">bindIp</span><span class="token punctuation">:</span> 127.0.0.1</span>
<span class="line"></span>
<span class="line"><span class="token key atrule">security</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">authorization</span><span class="token punctuation">:</span> enabled</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="连接-mongodb" tabindex="-1"><a class="header-anchor" href="#连接-mongodb"><span>连接 MongoDB</span></a></h3><p><strong>使用 MongoDB Shell (mongosh):</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">mongosh</span>
<span class="line"><span class="token comment"># 或连接到远程服务器</span></span>
<span class="line">mongosh <span class="token string">&quot;mongodb://username:password@hostname:27017&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="基础概念" tabindex="-1"><a class="header-anchor" href="#基础概念"><span>基础概念</span></a></h2><h3 id="数据模型" tabindex="-1"><a class="header-anchor" href="#数据模型"><span>数据模型</span></a></h3><ul><li><strong>数据库 (Database)</strong>: 数据库的容器,每个数据库都有独立的文件系统</li><li><strong>集合 (Collection)</strong>: 类似关系数据库中的表,存储文档的集合</li><li><strong>文档 (Document)</strong>: 基本数据单元,类似 JSON 对象,使用 BSON 格式存储</li><li><strong>字段 (Field)</strong>: 文档中的键值对</li></ul><h3 id="文档结构示例" tabindex="-1"><a class="header-anchor" href="#文档结构示例"><span>文档结构示例</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token string-property property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;507f1f77bcf86cd799439011&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;张三&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string-property property">&quot;age&quot;</span><span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string-property property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zhangsan@example.com&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string-property property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string-property property">&quot;city&quot;</span><span class="token operator">:</span> <span class="token string">&quot;北京&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string-property property">&quot;district&quot;</span><span class="token operator">:</span> <span class="token string">&quot;朝阳区&quot;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string-property property">&quot;hobbies&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;阅读&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;旅游&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;摄影&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string-property property">&quot;createdAt&quot;</span><span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2024-01-15T08:30:00Z&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="数据库操作" tabindex="-1"><a class="header-anchor" href="#数据库操作"><span>数据库操作</span></a></h2><h3 id="查看数据库" tabindex="-1"><a class="header-anchor" href="#查看数据库"><span>查看数据库</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// 显示所有数据库</span></span>
<span class="line">show dbs</span>
<span class="line"></span>
<span class="line"><span class="token comment">// 显示当前使用的数据库</span></span>
<span class="line">db</span>
<span class="line"></span>
<span class="line"><span class="token comment">// 查看数据库统计信息</span></span>
<span class="line">db<span class="token punctuation">.</span><span class="token function">stats</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="创建-切换数据库" tabindex="-1"><a class="header-anchor" href="#创建-切换数据库"><span>创建/切换数据库</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// 切换到指定数据库(如果不存在则创建)</span></span>
<span class="line">use myDatabase</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="删除数据库" tabindex="-1"><a class="header-anchor" href="#删除数据库"><span>删除数据库</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// 删除当前数据库</span></span>
<span class="line">db<span class="token punctuation">.</span><span class="token function">dropDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="集合操作" tabindex="-1"><a class="header-anchor" href="#集合操作"><span>集合操作</span></a></h2><h3 id="创建集合" tabindex="-1"><a class="header-anchor" href="#创建集合"><span>创建集合</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// 显式创建集合</span></span>
<span class="line">db<span class="token punctuation">.</span><span class="token function">createCollection</span><span class="token punctuation">(</span><span class="token string">&quot;users&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 创建带选项的集合</span></span>
<span class="line">db<span class="token punctuation">.</span><span class="token function">createCollection</span><span class="token punctuation">(</span><span class="token string">&quot;orders&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">capped</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>        <span class="token comment">// 固定大小集合</span></span>
<span class="line">  <span class="token literal-property property">size</span><span class="token operator">:</span> <span class="token number">5242880</span><span class="token punctuation">,</span>       <span class="token comment">// 最大字节数</span></span>
<span class="line">  <span class="token literal-property property">max</span><span class="token operator">:</span> <span class="token number">5000</span>            <span class="token comment">// 最大文档数</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 隐式创建(插入文档时自动创建)</span></span>
<span class="line">db<span class="token punctuation">.</span>products<span class="token punctuation">.</span><span class="token function">insertOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;商品1&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="查看集合" tabindex="-1"><a class="header-anchor" href="#查看集合"><span>查看集合</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// 显示所有集合</span></span>
<span class="line">show collections</span>
<span class="line"></span>
<span class="line"><span class="token comment">// 获取集合统计信息</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">stats</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="重命名集合" tabindex="-1"><a class="header-anchor" href="#重命名集合"><span>重命名集合</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">renameCollection</span><span class="token punctuation">(</span><span class="token string">&quot;customers&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="删除集合" tabindex="-1"><a class="header-anchor" href="#删除集合"><span>删除集合</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">drop</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><hr><h2 id="文档crud操作" tabindex="-1"><a class="header-anchor" href="#文档crud操作"><span>文档CRUD操作</span></a></h2><h3 id="插入文档" tabindex="-1"><a class="header-anchor" href="#插入文档"><span>插入文档</span></a></h3><p><strong>插入单个文档:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">insertOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;李四&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token string">&quot;lisi@example.com&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">createdAt</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>插入多个文档:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">insertMany</span><span class="token punctuation">(</span><span class="token punctuation">[</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;王五&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token string">&quot;wangwu@example.com&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;赵六&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token string">&quot;zhaoliu@example.com&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;孙七&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token string">&quot;sunqi@example.com&quot;</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="查询文档" tabindex="-1"><a class="header-anchor" href="#查询文档"><span>查询文档</span></a></h3><p><strong>查询所有文档:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>条件查询:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// 查询单个文档</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;李四&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 按条件查询</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$gte</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 返回指定字段(投影)</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">_id</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 限制返回数量</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 跳过指定数量</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 排序</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment">// -1降序, 1升序</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="更新文档" tabindex="-1"><a class="header-anchor" href="#更新文档"><span>更新文档</span></a></h3><p><strong>更新单个文档:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">updateOne</span><span class="token punctuation">(</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;李四&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token literal-property property">$set</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token string">&quot;lisi_new@example.com&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>更新多个文档:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">updateMany</span><span class="token punctuation">(</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$lt</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token literal-property property">$inc</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span>  <span class="token comment">// 年龄加1</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>替换文档:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">replaceOne</span><span class="token punctuation">(</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;李四&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;李四&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token string">&quot;lisi@example.com&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">updatedAt</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>常用更新操作符:</strong></p><ul><li><code>$set</code>: 设置字段值</li><li><code>$unset</code>: 删除字段</li><li><code>$inc</code>: 增加数值</li><li><code>$push</code>: 向数组添加元素</li><li><code>$pull</code>: 从数组删除元素</li><li><code>$addToSet</code>: 向数组添加唯一元素</li></ul><h3 id="删除文档" tabindex="-1"><a class="header-anchor" href="#删除文档"><span>删除文档</span></a></h3><p><strong>删除单个文档:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">deleteOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;李四&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>删除多个文档:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$lt</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>删除所有文档:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><hr><h2 id="查询操作" tabindex="-1"><a class="header-anchor" href="#查询操作"><span>查询操作</span></a></h2><h3 id="比较操作符" tabindex="-1"><a class="header-anchor" href="#比较操作符"><span>比较操作符</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// 等于</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 大于 ($gt), 大于等于 ($gte)</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$gt</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$gte</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 小于 ($lt), 小于等于 ($lte)</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$lt</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$lte</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 不等于 ($ne)</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$ne</span><span class="token operator">:</span> <span class="token string">&quot;inactive&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 在范围内 ($in)</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span>$<span class="token keyword">in</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 不在范围内 ($nin)</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$nin</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="逻辑操作符" tabindex="-1"><a class="header-anchor" href="#逻辑操作符"><span>逻辑操作符</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// AND (隐式)</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$gte</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token string">&quot;active&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// OR</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">$or</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$lt</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$gt</span><span class="token operator">:</span> <span class="token number">35</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// NOT</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$not</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$gte</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// NOR</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">$nor</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$lt</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">{</span><span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token string">&quot;inactive&quot;</span><span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="元素操作符" tabindex="-1"><a class="header-anchor" href="#元素操作符"><span>元素操作符</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// 字段存在</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$exists</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 类型检查</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$type</span><span class="token operator">:</span> <span class="token string">&quot;number&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="数组操作符" tabindex="-1"><a class="header-anchor" href="#数组操作符"><span>数组操作符</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// 包含指定元素</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">hobbies</span><span class="token operator">:</span> <span class="token string">&quot;阅读&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 包含所有指定元素</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">hobbies</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$all</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;阅读&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;旅游&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 数组大小</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">hobbies</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$size</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 数组元素匹配</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token string-property property">&quot;scores&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">$elemMatch</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$gte</span><span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token literal-property property">$lt</span><span class="token operator">:</span> <span class="token number">90</span><span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="正则表达式查询" tabindex="-1"><a class="header-anchor" href="#正则表达式查询"><span>正则表达式查询</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// 包含特定字符串</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$regex</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">张</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 以特定字符串开头</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$regex</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^zhangsan</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 不区分大小写</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$regex</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">zhang</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="嵌套文档查询" tabindex="-1"><a class="header-anchor" href="#嵌套文档查询"><span>嵌套文档查询</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// 精确匹配嵌套文档</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">city</span><span class="token operator">:</span> <span class="token string">&quot;北京&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">district</span><span class="token operator">:</span> <span class="token string">&quot;朝阳区&quot;</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 查询嵌套字段</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string-property property">&quot;address.city&quot;</span><span class="token operator">:</span> <span class="token string">&quot;北京&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="索引" tabindex="-1"><a class="header-anchor" href="#索引"><span>索引</span></a></h2><h3 id="创建索引" tabindex="-1"><a class="header-anchor" href="#创建索引"><span>创建索引</span></a></h3><p><strong>单字段索引:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// 升序索引</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 降序索引</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>复合索引:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>唯一索引:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">unique</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>稀疏索引:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// 只索引存在该字段的文档</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">phone</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">sparse</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>文本索引:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>articles<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 查询</span></span>
<span class="line">db<span class="token punctuation">.</span>articles<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">$text</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$search</span><span class="token operator">:</span> <span class="token string">&quot;MongoDB 教程&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>地理空间索引:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>places<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">location</span><span class="token operator">:</span> <span class="token string">&quot;2dsphere&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>TTL索引(自动过期):</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// 文档创建后3600秒自动删除</span></span>
<span class="line">db<span class="token punctuation">.</span>sessions<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">createdAt</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">expireAfterSeconds</span><span class="token operator">:</span> <span class="token number">3600</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="查看索引" tabindex="-1"><a class="header-anchor" href="#查看索引"><span>查看索引</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// 查看集合的所有索引</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">getIndexes</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 查看索引大小</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">totalIndexSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="删除索引" tabindex="-1"><a class="header-anchor" href="#删除索引"><span>删除索引</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// 删除指定索引</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">dropIndex</span><span class="token punctuation">(</span><span class="token string">&quot;name_1&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 删除所有索引(除了_id索引)</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">dropIndexes</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="分析查询性能" tabindex="-1"><a class="header-anchor" href="#分析查询性能"><span>分析查询性能</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// 使用 explain() 分析查询计划</span></span>
<span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$gte</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">explain</span><span class="token punctuation">(</span><span class="token string">&quot;executionStats&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="聚合操作" tabindex="-1"><a class="header-anchor" href="#聚合操作"><span>聚合操作</span></a></h2><p>聚合管道提供强大的数据处理和分析功能。</p><h3 id="基本聚合阶段" tabindex="-1"><a class="header-anchor" href="#基本聚合阶段"><span>基本聚合阶段</span></a></h3><p><strong>$match - 过滤文档:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>orders<span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token punctuation">[</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token literal-property property">$match</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token string">&quot;completed&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>$group - 分组统计:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>orders<span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token punctuation">[</span></span>
<span class="line">  <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">$group</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">_id</span><span class="token operator">:</span> <span class="token string">&quot;$customerId&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">totalAmount</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$sum</span><span class="token operator">:</span> <span class="token string">&quot;$amount&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">orderCount</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$sum</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">avgAmount</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$avg</span><span class="token operator">:</span> <span class="token string">&quot;$amount&quot;</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>$project - 字段投影:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token punctuation">[</span></span>
<span class="line">  <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">$project</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">ageGroup</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">$cond</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token keyword">if</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$gte</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;$age&quot;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">          <span class="token literal-property property">then</span><span class="token operator">:</span> <span class="token string">&quot;成年&quot;</span><span class="token punctuation">,</span></span>
<span class="line">          <span class="token keyword">else</span><span class="token operator">:</span> <span class="token string">&quot;青年&quot;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>$sort - 排序:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>orders<span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token punctuation">[</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token literal-property property">$sort</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">amount</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>$limit 和 $skip:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token punctuation">[</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token literal-property property">$sort</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token literal-property property">$skip</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token literal-property property">$limit</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>$lookup - 关联查询:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>orders<span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token punctuation">[</span></span>
<span class="line">  <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">$lookup</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">from</span><span class="token operator">:</span> <span class="token string">&quot;customers&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">localField</span><span class="token operator">:</span> <span class="token string">&quot;customerId&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">foreignField</span><span class="token operator">:</span> <span class="token string">&quot;_id&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token keyword">as</span><span class="token operator">:</span> <span class="token string">&quot;customerInfo&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>$unwind - 展开数组:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token punctuation">[</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token literal-property property">$unwind</span><span class="token operator">:</span> <span class="token string">&quot;$hobbies&quot;</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="聚合操作符" tabindex="-1"><a class="header-anchor" href="#聚合操作符"><span>聚合操作符</span></a></h3><p><strong>算术操作符:</strong></p><ul><li><code>$add</code>, <code>$subtract</code>, <code>$multiply</code>, <code>$divide</code></li><li><code>$mod</code>, <code>$abs</code>, <code>$ceil</code>, <code>$floor</code></li></ul><p><strong>字符串操作符:</strong></p><ul><li><code>$concat</code>, <code>$substr</code>, <code>$toLower</code>, <code>$toUpper</code></li><li><code>$split</code>, <code>$trim</code></li></ul><p><strong>日期操作符:</strong></p><ul><li><code>$year</code>, <code>$month</code>, <code>$dayOfMonth</code></li><li><code>$hour</code>, <code>$minute</code>, <code>$second</code></li></ul><p><strong>条件操作符:</strong></p><ul><li><code>$cond</code>, <code>$ifNull</code>, <code>$switch</code></li></ul><h3 id="聚合示例" tabindex="-1"><a class="header-anchor" href="#聚合示例"><span>聚合示例</span></a></h3><p><strong>计算每月销售额:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>orders<span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token punctuation">[</span></span>
<span class="line">  <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">$group</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">_id</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">year</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$year</span><span class="token operator">:</span> <span class="token string">&quot;$orderDate&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">month</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$month</span><span class="token operator">:</span> <span class="token string">&quot;$orderDate&quot;</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">totalSales</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$sum</span><span class="token operator">:</span> <span class="token string">&quot;$amount&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">orderCount</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$sum</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token literal-property property">$sort</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;_id.year&quot;</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;_id.month&quot;</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>用户消费排行榜:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">db<span class="token punctuation">.</span>orders<span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token punctuation">[</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token literal-property property">$match</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token string">&quot;completed&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">$group</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">_id</span><span class="token operator">:</span> <span class="token string">&quot;$customerId&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">totalSpent</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$sum</span><span class="token operator">:</span> <span class="token string">&quot;$amount&quot;</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token literal-property property">$sort</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">totalSpent</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token literal-property property">$limit</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">$lookup</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">from</span><span class="token operator">:</span> <span class="token string">&quot;customers&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">localField</span><span class="token operator">:</span> <span class="token string">&quot;_id&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">foreignField</span><span class="token operator">:</span> <span class="token string">&quot;_id&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token keyword">as</span><span class="token operator">:</span> <span class="token string">&quot;customer&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token literal-property property">$unwind</span><span class="token operator">:</span> <span class="token string">&quot;$customer&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">$project</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">customerName</span><span class="token operator">:</span> <span class="token string">&quot;$customer.name&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">totalSpent</span><span class="token operator">:</span> <span class="token number">1</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="事务" tabindex="-1"><a class="header-anchor" href="#事务"><span>事务</span></a></h2><p>MongoDB 支持多文档 ACID 事务,确保数据一致性。</p><h3 id="使用事务" tabindex="-1"><a class="header-anchor" href="#使用事务"><span>使用事务</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token keyword">const</span> session <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">getMongo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">session<span class="token punctuation">.</span><span class="token function">startTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> ordersCollection <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">getDatabase</span><span class="token punctuation">(</span><span class="token string">&quot;mydb&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>orders</span>
<span class="line">  <span class="token keyword">const</span> inventoryCollection <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">getDatabase</span><span class="token punctuation">(</span><span class="token string">&quot;mydb&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>inventory</span>
<span class="line">  </span>
<span class="line">  <span class="token comment">// 创建订单</span></span>
<span class="line">  ordersCollection<span class="token punctuation">.</span><span class="token function">insertOne</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">orderId</span><span class="token operator">:</span> <span class="token string">&quot;ORD-001&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">productId</span><span class="token operator">:</span> <span class="token string">&quot;PROD-001&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">quantity</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token string">&quot;pending&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">{</span>session<span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">)</span></span>
<span class="line">  </span>
<span class="line">  <span class="token comment">// 减少库存</span></span>
<span class="line">  inventoryCollection<span class="token punctuation">.</span><span class="token function">updateOne</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token punctuation">{</span><span class="token literal-property property">productId</span><span class="token operator">:</span> <span class="token string">&quot;PROD-001&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">{</span><span class="token literal-property property">$inc</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">stock</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">{</span>session<span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">)</span></span>
<span class="line">  </span>
<span class="line">  <span class="token comment">// 提交事务</span></span>
<span class="line">  session<span class="token punctuation">.</span><span class="token function">commitTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;事务提交成功&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  </span>
<span class="line"><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// 回滚事务</span></span>
<span class="line">  session<span class="token punctuation">.</span><span class="token function">abortTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;事务回滚: &quot;</span> <span class="token operator">+</span> error<span class="token punctuation">)</span></span>
<span class="line">  </span>
<span class="line"><span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span></span>
<span class="line">  session<span class="token punctuation">.</span><span class="token function">endSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="事务注意事项" tabindex="-1"><a class="header-anchor" href="#事务注意事项"><span>事务注意事项</span></a></h3><ul><li>事务只能在副本集或分片集群上使用</li><li>事务有60秒的默认超时时间</li><li>避免在事务中执行长时间运行的操作</li><li>事务中的所有操作必须在同一个会话中</li></ul><hr><h2 id="用户管理与安全" tabindex="-1"><a class="header-anchor" href="#用户管理与安全"><span>用户管理与安全</span></a></h2><h3 id="创建管理员用户" tabindex="-1"><a class="header-anchor" href="#创建管理员用户"><span>创建管理员用户</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">use admin</span>
<span class="line"></span>
<span class="line">db<span class="token punctuation">.</span><span class="token function">createUser</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">pwd</span><span class="token operator">:</span> <span class="token string">&quot;securePassword123&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">roles</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span><span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token string">&quot;userAdminAnyDatabase&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">db</span><span class="token operator">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">{</span><span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token string">&quot;readWriteAnyDatabase&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">db</span><span class="token operator">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="创建普通用户" tabindex="-1"><a class="header-anchor" href="#创建普通用户"><span>创建普通用户</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">use myDatabase</span>
<span class="line"></span>
<span class="line">db<span class="token punctuation">.</span><span class="token function">createUser</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token string">&quot;appUser&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">pwd</span><span class="token operator">:</span> <span class="token string">&quot;appPassword123&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">roles</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span><span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token string">&quot;readWrite&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">db</span><span class="token operator">:</span> <span class="token string">&quot;myDatabase&quot;</span><span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="常用角色" tabindex="-1"><a class="header-anchor" href="#常用角色"><span>常用角色</span></a></h3><p><strong>数据库角色:</strong></p><ul><li><code>read</code>: 读取权限</li><li><code>readWrite</code>: 读写权限</li><li><code>dbAdmin</code>: 数据库管理权限</li><li><code>dbOwner</code>: 数据库所有者权限</li></ul><p><strong>集群角色:</strong></p><ul><li><code>clusterAdmin</code>: 集群管理权限</li><li><code>clusterMonitor</code>: 集群监控权限</li></ul><p><strong>全局角色:</strong></p><ul><li><code>readAnyDatabase</code>: 读取所有数据库</li><li><code>readWriteAnyDatabase</code>: 读写所有数据库</li><li><code>userAdminAnyDatabase</code>: 用户管理权限</li><li><code>dbAdminAnyDatabase</code>: 数据库管理权限</li></ul><h3 id="用户管理操作" tabindex="-1"><a class="header-anchor" href="#用户管理操作"><span>用户管理操作</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// 查看当前数据库的用户</span></span>
<span class="line">db<span class="token punctuation">.</span><span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 修改用户密码</span></span>
<span class="line">db<span class="token punctuation">.</span><span class="token function">changeUserPassword</span><span class="token punctuation">(</span><span class="token string">&quot;appUser&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;newPassword456&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 授予角色</span></span>
<span class="line">db<span class="token punctuation">.</span><span class="token function">grantRolesToUser</span><span class="token punctuation">(</span><span class="token string">&quot;appUser&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token string">&quot;read&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">db</span><span class="token operator">:</span> <span class="token string">&quot;anotherDB&quot;</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 撤销角色</span></span>
<span class="line">db<span class="token punctuation">.</span><span class="token function">revokeRolesFromUser</span><span class="token punctuation">(</span><span class="token string">&quot;appUser&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token literal-property property">role</span><span class="token operator">:</span> <span class="token string">&quot;read&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">db</span><span class="token operator">:</span> <span class="token string">&quot;anotherDB&quot;</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 删除用户</span></span>
<span class="line">db<span class="token punctuation">.</span><span class="token function">dropUser</span><span class="token punctuation">(</span><span class="token string">&quot;appUser&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="启用访问控制" tabindex="-1"><a class="header-anchor" href="#启用访问控制"><span>启用访问控制</span></a></h3><p>在配置文件中启用认证:</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">security</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">authorization</span><span class="token punctuation">:</span> enabled</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>连接时使用认证:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">mongosh <span class="token string">&quot;mongodb://username:password@localhost:27017/database?authSource=admin&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><hr><h2 id="备份与恢复" tabindex="-1"><a class="header-anchor" href="#备份与恢复"><span>备份与恢复</span></a></h2><h3 id="使用-mongodump-备份" tabindex="-1"><a class="header-anchor" href="#使用-mongodump-备份"><span>使用 mongodump 备份</span></a></h3><p><strong>备份整个数据库:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">mongodump <span class="token parameter variable">--db</span><span class="token operator">=</span>myDatabase <span class="token parameter variable">--out</span><span class="token operator">=</span>/backup/directory</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>备份特定集合:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">mongodump <span class="token parameter variable">--db</span><span class="token operator">=</span>myDatabase <span class="token parameter variable">--collection</span><span class="token operator">=</span>users <span class="token parameter variable">--out</span><span class="token operator">=</span>/backup/directory</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>备份所有数据库:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">mongodump <span class="token parameter variable">--out</span><span class="token operator">=</span>/backup/directory</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>带认证的备份:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">mongodump <span class="token parameter variable">--host</span><span class="token operator">=</span>localhost <span class="token parameter variable">--port</span><span class="token operator">=</span><span class="token number">27017</span> <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">--username</span><span class="token operator">=</span>admin <span class="token parameter variable">--password</span><span class="token operator">=</span>password <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">--authenticationDatabase</span><span class="token operator">=</span>admin <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">--db</span><span class="token operator">=</span>myDatabase <span class="token parameter variable">--out</span><span class="token operator">=</span>/backup/directory</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="使用-mongorestore-恢复" tabindex="-1"><a class="header-anchor" href="#使用-mongorestore-恢复"><span>使用 mongorestore 恢复</span></a></h3><p><strong>恢复数据库:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">mongorestore <span class="token parameter variable">--db</span><span class="token operator">=</span>myDatabase /backup/directory/myDatabase</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>恢复特定集合:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">mongorestore <span class="token parameter variable">--db</span><span class="token operator">=</span>myDatabase <span class="token parameter variable">--collection</span><span class="token operator">=</span>users <span class="token punctuation">\\</span></span>
<span class="line">  /backup/directory/myDatabase/users.bson</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>恢复所有数据库:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">mongorestore /backup/directory</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>删除现有数据后恢复:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">mongorestore <span class="token parameter variable">--drop</span> <span class="token parameter variable">--db</span><span class="token operator">=</span>myDatabase /backup/directory/myDatabase</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="导出和导入-json-csv" tabindex="-1"><a class="header-anchor" href="#导出和导入-json-csv"><span>导出和导入 JSON/CSV</span></a></h3><p><strong>导出为JSON:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">mongoexport <span class="token parameter variable">--db</span><span class="token operator">=</span>myDatabase <span class="token parameter variable">--collection</span><span class="token operator">=</span>users <span class="token parameter variable">--out</span><span class="token operator">=</span>users.json</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>导出为CSV:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">mongoexport <span class="token parameter variable">--db</span><span class="token operator">=</span>myDatabase <span class="token parameter variable">--collection</span><span class="token operator">=</span>users <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">--type</span><span class="token operator">=</span>csv <span class="token parameter variable">--fields</span><span class="token operator">=</span>name,email,age <span class="token parameter variable">--out</span><span class="token operator">=</span>users.csv</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>导入JSON:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">mongoimport <span class="token parameter variable">--db</span><span class="token operator">=</span>myDatabase <span class="token parameter variable">--collection</span><span class="token operator">=</span>users <span class="token parameter variable">--file</span><span class="token operator">=</span>users.json</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>导入CSV:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">mongoimport <span class="token parameter variable">--db</span><span class="token operator">=</span>myDatabase <span class="token parameter variable">--collection</span><span class="token operator">=</span>users <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">--type</span><span class="token operator">=</span>csv <span class="token parameter variable">--headerline</span> <span class="token parameter variable">--file</span><span class="token operator">=</span>users.csv</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="性能优化" tabindex="-1"><a class="header-anchor" href="#性能优化"><span>性能优化</span></a></h2><h3 id="索引优化" tabindex="-1"><a class="header-anchor" href="#索引优化"><span>索引优化</span></a></h3><ul><li>为频繁查询的字段创建索引</li><li>使用复合索引优化多字段查询</li><li>定期检查和删除未使用的索引</li><li>使用覆盖查询(查询字段全部在索引中)</li></ul><p><strong>检查慢查询:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// 启用慢查询日志</span></span>
<span class="line">db<span class="token punctuation">.</span><span class="token function">setProfilingLevel</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">slowms</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 查看慢查询</span></span>
<span class="line">db<span class="token punctuation">.</span>system<span class="token punctuation">.</span>profile<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">ts</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="查询优化" tabindex="-1"><a class="header-anchor" href="#查询优化"><span>查询优化</span></a></h3><ul><li>使用投影只返回需要的字段</li><li>合理使用 <code>limit()</code> 限制返回数量</li><li>避免使用 <code>$where</code> 和 JavaScript 表达式</li><li>使用 <code>explain()</code> 分析查询计划</li></ul><h3 id="文档设计优化" tabindex="-1"><a class="header-anchor" href="#文档设计优化"><span>文档设计优化</span></a></h3><ul><li>考虑嵌入式文档 vs 引用</li><li>避免文档过大(BSON限制16MB)</li><li>合理使用数组,避免无限增长</li><li>考虑数据访问模式设计schema</li></ul><h3 id="连接池配置" tabindex="-1"><a class="header-anchor" href="#连接池配置"><span>连接池配置</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// 设置连接池大小</span></span>
<span class="line"><span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MongoClient</span><span class="token punctuation">(</span>uri<span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">maxPoolSize</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">minPoolSize</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">maxIdleTimeMS</span><span class="token operator">:</span> <span class="token number">30000</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="硬件和配置优化" tabindex="-1"><a class="header-anchor" href="#硬件和配置优化"><span>硬件和配置优化</span></a></h3><ul><li>使用SSD存储提升IO性能</li><li>增加RAM以支持更多数据在内存中</li><li>配置适当的WiredTiger缓存大小</li><li>启用压缩节省存储空间</li></ul><p><strong>配置WiredTiger引擎:</strong></p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">storage</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">engine</span><span class="token punctuation">:</span> wiredTiger</span>
<span class="line">  <span class="token key atrule">wiredTiger</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">engineConfig</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">cacheSizeGB</span><span class="token punctuation">:</span> <span class="token number">2</span></span>
<span class="line">    <span class="token key atrule">collectionConfig</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">blockCompressor</span><span class="token punctuation">:</span> snappy</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="监控和维护" tabindex="-1"><a class="header-anchor" href="#监控和维护"><span>监控和维护</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// 查看数据库状态</span></span>
<span class="line">db<span class="token punctuation">.</span><span class="token function">serverStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 查看当前操作</span></span>
<span class="line">db<span class="token punctuation">.</span><span class="token function">currentOp</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 终止长时间运行的操作</span></span>
<span class="line">db<span class="token punctuation">.</span><span class="token function">killOp</span><span class="token punctuation">(</span>operationId<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 查看统计信息</span></span>
<span class="line">db<span class="token punctuation">.</span><span class="token function">stats</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">db<span class="token punctuation">.</span>collection<span class="token punctuation">.</span><span class="token function">stats</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 分析集合</span></span>
<span class="line">db<span class="token punctuation">.</span>collection<span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="附录" tabindex="-1"><a class="header-anchor" href="#附录"><span>附录</span></a></h2><h3 id="常用命令速查" tabindex="-1"><a class="header-anchor" href="#常用命令速查"><span>常用命令速查</span></a></h3><p><strong>数据库操作:</strong></p><ul><li><code>show dbs</code> - 显示所有数据库</li><li><code>use &lt;db&gt;</code> - 切换数据库</li><li><code>db.dropDatabase()</code> - 删除当前数据库</li></ul><p><strong>集合操作:</strong></p><ul><li><code>show collections</code> - 显示所有集合</li><li><code>db.createCollection()</code> - 创建集合</li><li><code>db.&lt;collection&gt;.drop()</code> - 删除集合</li></ul><p><strong>文档操作:</strong></p><ul><li><code>insertOne()</code> / <code>insertMany()</code> - 插入</li><li><code>find()</code> / <code>findOne()</code> - 查询</li><li><code>updateOne()</code> / <code>updateMany()</code> - 更新</li><li><code>deleteOne()</code> / <code>deleteMany()</code> - 删除</li></ul><p><strong>索引操作:</strong></p><ul><li><code>createIndex()</code> - 创建索引</li><li><code>getIndexes()</code> - 查看索引</li><li><code>dropIndex()</code> - 删除索引</li></ul><h3 id="数据类型" tabindex="-1"><a class="header-anchor" href="#数据类型"><span>数据类型</span></a></h3><ul><li>String: 字符串</li><li>Integer: 整数(32位或64位)</li><li>Double: 双精度浮点数</li><li>Boolean: 布尔值</li><li>Object: 嵌套文档</li><li>Array: 数组</li><li>ObjectId: 对象ID</li><li>Date: 日期时间</li><li>Null: 空值</li><li>Binary Data: 二进制数据</li><li>Regular Expression: 正则表达式</li></ul><h3 id="最佳实践" tabindex="-1"><a class="header-anchor" href="#最佳实践"><span>最佳实践</span></a></h3><ol><li><strong>安全性</strong>: 始终启用认证,使用强密码,限制网络访问</li><li><strong>备份</strong>: 定期备份数据,测试恢复流程</li><li><strong>索引</strong>: 根据查询模式创建合适的索引</li><li><strong>监控</strong>: 监控性能指标,及时发现问题</li><li><strong>更新</strong>: 保持MongoDB版本更新,获取新特性和安全补丁</li><li><strong>测试</strong>: 在生产环境部署前充分测试</li><li><strong>文档</strong>: 记录数据模型和重要的业务逻辑</li></ol><hr><p><strong>参考资源:</strong></p><ul><li>MongoDB官方文档: https://docs.mongodb.com/</li><li>MongoDB大学: https://university.mongodb.com/</li><li>MongoDB社区论坛: https://www.mongodb.com/community/forums/</li></ul><hr><p><em>本手册基于MongoDB 7.0版本编写,某些功能在不同版本中可能有所差异。</em></p>`,237))])}const k=t(c,[["render",r],["__file","index.html.vue"]]),v=JSON.parse('{"path":"/books/mongodb-handbook/","title":"MongoDB 使用手册","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"简介","slug":"简介","link":"#简介","children":[]},{"level":2,"title":"安装与配置","slug":"安装与配置","link":"#安装与配置","children":[{"level":3,"title":"安装 MongoDB","slug":"安装-mongodb","link":"#安装-mongodb","children":[]},{"level":3,"title":"配置文件","slug":"配置文件","link":"#配置文件","children":[]},{"level":3,"title":"连接 MongoDB","slug":"连接-mongodb","link":"#连接-mongodb","children":[]}]},{"level":2,"title":"基础概念","slug":"基础概念","link":"#基础概念","children":[{"level":3,"title":"数据模型","slug":"数据模型","link":"#数据模型","children":[]},{"level":3,"title":"文档结构示例","slug":"文档结构示例","link":"#文档结构示例","children":[]}]},{"level":2,"title":"数据库操作","slug":"数据库操作","link":"#数据库操作","children":[{"level":3,"title":"查看数据库","slug":"查看数据库","link":"#查看数据库","children":[]},{"level":3,"title":"创建/切换数据库","slug":"创建-切换数据库","link":"#创建-切换数据库","children":[]},{"level":3,"title":"删除数据库","slug":"删除数据库","link":"#删除数据库","children":[]}]},{"level":2,"title":"集合操作","slug":"集合操作","link":"#集合操作","children":[{"level":3,"title":"创建集合","slug":"创建集合","link":"#创建集合","children":[]},{"level":3,"title":"查看集合","slug":"查看集合","link":"#查看集合","children":[]},{"level":3,"title":"重命名集合","slug":"重命名集合","link":"#重命名集合","children":[]},{"level":3,"title":"删除集合","slug":"删除集合","link":"#删除集合","children":[]}]},{"level":2,"title":"文档CRUD操作","slug":"文档crud操作","link":"#文档crud操作","children":[{"level":3,"title":"插入文档","slug":"插入文档","link":"#插入文档","children":[]},{"level":3,"title":"查询文档","slug":"查询文档","link":"#查询文档","children":[]},{"level":3,"title":"更新文档","slug":"更新文档","link":"#更新文档","children":[]},{"level":3,"title":"删除文档","slug":"删除文档","link":"#删除文档","children":[]}]},{"level":2,"title":"查询操作","slug":"查询操作","link":"#查询操作","children":[{"level":3,"title":"比较操作符","slug":"比较操作符","link":"#比较操作符","children":[]},{"level":3,"title":"逻辑操作符","slug":"逻辑操作符","link":"#逻辑操作符","children":[]},{"level":3,"title":"元素操作符","slug":"元素操作符","link":"#元素操作符","children":[]},{"level":3,"title":"数组操作符","slug":"数组操作符","link":"#数组操作符","children":[]},{"level":3,"title":"正则表达式查询","slug":"正则表达式查询","link":"#正则表达式查询","children":[]},{"level":3,"title":"嵌套文档查询","slug":"嵌套文档查询","link":"#嵌套文档查询","children":[]}]},{"level":2,"title":"索引","slug":"索引","link":"#索引","children":[{"level":3,"title":"创建索引","slug":"创建索引","link":"#创建索引","children":[]},{"level":3,"title":"查看索引","slug":"查看索引","link":"#查看索引","children":[]},{"level":3,"title":"删除索引","slug":"删除索引","link":"#删除索引","children":[]},{"level":3,"title":"分析查询性能","slug":"分析查询性能","link":"#分析查询性能","children":[]}]},{"level":2,"title":"聚合操作","slug":"聚合操作","link":"#聚合操作","children":[{"level":3,"title":"基本聚合阶段","slug":"基本聚合阶段","link":"#基本聚合阶段","children":[]},{"level":3,"title":"聚合操作符","slug":"聚合操作符","link":"#聚合操作符","children":[]},{"level":3,"title":"聚合示例","slug":"聚合示例","link":"#聚合示例","children":[]}]},{"level":2,"title":"事务","slug":"事务","link":"#事务","children":[{"level":3,"title":"使用事务","slug":"使用事务","link":"#使用事务","children":[]},{"level":3,"title":"事务注意事项","slug":"事务注意事项","link":"#事务注意事项","children":[]}]},{"level":2,"title":"用户管理与安全","slug":"用户管理与安全","link":"#用户管理与安全","children":[{"level":3,"title":"创建管理员用户","slug":"创建管理员用户","link":"#创建管理员用户","children":[]},{"level":3,"title":"创建普通用户","slug":"创建普通用户","link":"#创建普通用户","children":[]},{"level":3,"title":"常用角色","slug":"常用角色","link":"#常用角色","children":[]},{"level":3,"title":"用户管理操作","slug":"用户管理操作","link":"#用户管理操作","children":[]},{"level":3,"title":"启用访问控制","slug":"启用访问控制","link":"#启用访问控制","children":[]}]},{"level":2,"title":"备份与恢复","slug":"备份与恢复","link":"#备份与恢复","children":[{"level":3,"title":"使用 mongodump 备份","slug":"使用-mongodump-备份","link":"#使用-mongodump-备份","children":[]},{"level":3,"title":"使用 mongorestore 恢复","slug":"使用-mongorestore-恢复","link":"#使用-mongorestore-恢复","children":[]},{"level":3,"title":"导出和导入 JSON/CSV","slug":"导出和导入-json-csv","link":"#导出和导入-json-csv","children":[]}]},{"level":2,"title":"性能优化","slug":"性能优化","link":"#性能优化","children":[{"level":3,"title":"索引优化","slug":"索引优化","link":"#索引优化","children":[]},{"level":3,"title":"查询优化","slug":"查询优化","link":"#查询优化","children":[]},{"level":3,"title":"文档设计优化","slug":"文档设计优化","link":"#文档设计优化","children":[]},{"level":3,"title":"连接池配置","slug":"连接池配置","link":"#连接池配置","children":[]},{"level":3,"title":"硬件和配置优化","slug":"硬件和配置优化","link":"#硬件和配置优化","children":[]},{"level":3,"title":"监控和维护","slug":"监控和维护","link":"#监控和维护","children":[]}]},{"level":2,"title":"附录","slug":"附录","link":"#附录","children":[{"level":3,"title":"常用命令速查","slug":"常用命令速查","link":"#常用命令速查","children":[]},{"level":3,"title":"数据类型","slug":"数据类型","link":"#数据类型","children":[]},{"level":3,"title":"最佳实践","slug":"最佳实践","link":"#最佳实践","children":[]}]}],"git":{},"filePathRelative":"books/mongodb-handbook/index.md"}');export{k as comp,v as data};
