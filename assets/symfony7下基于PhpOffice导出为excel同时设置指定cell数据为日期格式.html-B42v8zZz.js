import{_ as s,c as a,f as p,o as t}from"./app-BB_BIQV8.js";const e={};function l(c,n){return t(),a("div",null,n[0]||(n[0]=[p(`<h4 id="symfony7下基于phpoffice导出为excel-同时设置指定cell数据为日期格式-方便排序" tabindex="-1"><a class="header-anchor" href="#symfony7下基于phpoffice导出为excel-同时设置指定cell数据为日期格式-方便排序"><span>symfony7下基于PhpOffice导出为excel，同时设置指定cell数据为日期格式，方便排序</span></a></h4><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line">PhpOffice\\PhpSpreadsheet\\Spreadsheet</span>
<span class="line"></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">setExcelDateCell</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Worksheet</span> <span class="token variable">$sheet</span><span class="token punctuation">,</span> <span class="token keyword type-hint">string</span> <span class="token variable">$cellCoordinate</span><span class="token punctuation">,</span> <span class="token keyword type-hint">string</span> <span class="token variable">$period</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">void</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// 完整日期 Y-m-d</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;/^\\d{4}-\\d{2}-\\d{2}$/&#39;</span><span class="token punctuation">,</span> <span class="token variable">$period</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token variable">$date</span> <span class="token operator">=</span> <span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\\</span>DateTime</span><span class="token operator">::</span><span class="token function">createFromFormat</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Y-m-d&#39;</span><span class="token punctuation">,</span> <span class="token variable">$period</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$date</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token variable">$date</span><span class="token operator">-&gt;</span><span class="token function">setTime</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 关键：归零时间</span></span>
<span class="line">            <span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token variable">$cellCoordinate</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\\</span>PhpOffice<span class="token punctuation">\\</span>PhpSpreadsheet<span class="token punctuation">\\</span>Shared<span class="token punctuation">\\</span>Date</span><span class="token operator">::</span><span class="token function">PHPToExcel</span><span class="token punctuation">(</span><span class="token variable">$date</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getStyle</span><span class="token punctuation">(</span><span class="token variable">$cellCoordinate</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token operator">-&gt;</span><span class="token function">getNumberFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token operator">-&gt;</span><span class="token function">setFormatCode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;dd-mmm-yy&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 显示 21-May-25</span></span>
<span class="line">        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token variable">$cellCoordinate</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token variable">$period</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;/^\\d{4}-\\d{2}$/&#39;</span><span class="token punctuation">,</span> <span class="token variable">$period</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> </span>
<span class="line">       <span class="token comment">// 年-月 Y-m</span></span>
<span class="line">        <span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token variable">$cellCoordinate</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">formatDate</span><span class="token punctuation">(</span><span class="token variable">$period</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// 其他格式直接原样写</span></span>
<span class="line">        <span class="token variable">$sheet</span><span class="token operator">-&gt;</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token variable">$cellCoordinate</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token variable">$period</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> <span class="token function-definition function">formatDate</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$dateString</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// 完整日期 Y-m-d</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;/^\\d{4}-\\d{2}-\\d{2}$/&#39;</span><span class="token punctuation">,</span> <span class="token variable">$dateString</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token variable">$date</span> <span class="token operator">=</span> <span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\\</span>DateTime</span><span class="token operator">::</span><span class="token function">createFromFormat</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Y-m-d&#39;</span><span class="token punctuation">,</span> <span class="token variable">$dateString</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$date</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\\</span>InvalidArgumentException</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Invalid date format: <span class="token interpolation"><span class="token variable">$dateString</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">return</span> <span class="token variable">$date</span><span class="token operator">-&gt;</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;d-M-y&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 15-May-24</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">   <span class="token comment">// 年-月 Y-m</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;/^\\d{4}-\\d{2}$/&#39;</span><span class="token punctuation">,</span> <span class="token variable">$dateString</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token variable">$date</span> <span class="token operator">=</span> <span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\\</span>DateTime</span><span class="token operator">::</span><span class="token function">createFromFormat</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Y-m-d&#39;</span><span class="token punctuation">,</span> <span class="token variable">$dateString</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39;-01&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$date</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\\</span>InvalidArgumentException</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Invalid year-month format: <span class="token interpolation"><span class="token variable">$dateString</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">return</span> <span class="token variable">$date</span><span class="token operator">-&gt;</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;M Y&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// May 2024</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\\</span>InvalidArgumentException</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Unsupported date format: <span class="token interpolation"><span class="token variable">$dateString</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2)]))}const i=s(e,[["render",l],["__file","symfony7下基于PhpOffice导出为excel同时设置指定cell数据为日期格式.html.vue"]]),u=JSON.parse('{"path":"/content/other/spread/symfony7%E4%B8%8B%E5%9F%BA%E4%BA%8EPhpOffice%E5%AF%BC%E5%87%BA%E4%B8%BAexcel%E5%90%8C%E6%97%B6%E8%AE%BE%E7%BD%AE%E6%8C%87%E5%AE%9Acell%E6%95%B0%E6%8D%AE%E4%B8%BA%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F.html","title":"symfony7下基于PhpOffice导出为excel同时设置指定cell数据为日期格式","lang":"en-US","frontmatter":{"sidebar":false,"title":"symfony7下基于PhpOffice导出为excel同时设置指定cell数据为日期格式","head":[["meta",{"name":"title","content":"symfony7下基于PhpOffice导出为excel同时设置指定cell数据为日期格式"}],["meta",{"name":"description","content":"symfony7下基于PhpOffice导出为excel同时设置指定cell数据为日期格式"}],["meta",{"name":"keywords","content":"PhpOffice,excel"}],["meta",{"property":"og:title","content":"symfony7下基于PhpOffice导出为excel同时设置指定cell数据为日期格式"}],["meta",{"property":"og:description","content":"symfony7下基于PhpOffice导出为excel同时设置指定cell数据为日期格式"}]]},"headers":[],"git":{},"filePathRelative":"content/other/spread/symfony7下基于PhpOffice导出为excel同时设置指定cell数据为日期格式.md"}');export{i as comp,u as data};
